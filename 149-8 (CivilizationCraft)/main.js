/*
BUILD INFO:
  dir: dev
  target: main.js
  files: 28
*/



// file: header.js

//ðŸ‡¨â€‹ðŸ‡®â€‹ðŸ‡»â€‹ðŸ‡®â€‹ðŸ‡±â€‹ðŸ‡®â€‹ðŸ‡¿â€‹ðŸ‡¦â€‹ðŸ‡¹â€‹ðŸ‡®â€‹ðŸ‡´â€‹ðŸ‡³â€‹ ðŸ‡¨â€‹ðŸ‡·â€‹ðŸ‡¦â€‹ðŸ‡«â€‹ðŸ‡¹â€‹ by Toncho.

//translate items

//TOOLS
Translation.addTranslation("Stone axe", {ru: "ÐšÐ°Ð¼ÐµÐ½Ð½Ñ‹Ð¹ Ñ‚Ð¾Ð¿Ð¾Ñ€"});
Translation.addTranslation("Stone pickaxe", {ru: "ÐšÐ°Ð¼ÐµÐ½Ð½Ð°Ñ ÐºÐ¸Ñ€ÐºÐ°"});
Translation.addTranslation("Stone hammer", {ru: "ÐšÐ°Ð¼ÐµÐ½Ð½Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ñ‚"});

Translation.addTranslation("Flint axe", {ru: "ÐšÑ€ÐµÐ¼Ð½ÐµÐ²Ñ‹Ð¹ Ñ‚Ð¾Ð¿Ð¾Ñ€"});
Translation.addTranslation("Flint pickaxe", {ru: "ÐšÑ€ÐµÐ¼Ð½ÐµÐ²Ð°Ñ ÐºÐ¸Ñ€ÐºÐ°"});
Translation.addTranslation("Flint workblade", {ru: "ÐšÑ€ÐµÐ¼Ð½ÐµÐ²Ñ‹Ð¹ Ð½Ð¾Ð¶"});
Translation.addTranslation("Flint shovel", {ru: "ÐšÑ€ÐµÐ¼Ð½ÐµÐ²Ð°Ñ Ð»Ð¾Ð¿Ð°Ñ‚Ð°"});

Translation.addTranslation("Iron axe", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ Ñ‚Ð¾Ð¿Ð¾Ñ€"});
Translation.addTranslation("Iron pickaxe", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð°Ñ ÐºÐ¸Ñ€ÐºÐ°"});
Translation.addTranslation("Iron sword", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ Ð¼ÐµÑ‡"});
Translation.addTranslation("Iron shovel", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð°Ñ Ð»Ð¾Ð¿Ð°Ñ‚Ð°"});
Translation.addTranslation("Iron hammer", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ñ‚"});
Translation.addTranslation("Iron file", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ Ð½Ð°Ð¿Ð¸Ð»ÑŒÐ½Ð¸Ðº"});

Translation.addTranslation("Cobalt axe", {ru: "ÐšÐ¾Ð±Ð°Ð»ÑŒÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ‚Ð¾Ð¿Ð¾Ñ€"});
Translation.addTranslation("Cobalt pickaxe", {ru: "ÐšÐ¾Ð±Ð°Ð»ÑŒÑ‚Ð¾Ð²Ð°Ñ‹ ÐºÐ¸Ñ€ÐºÐ°"});
Translation.addTranslation("Cobalt sword", {ru: "ÐšÐ¾Ð±Ð°Ð»ÑŒÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¼ÐµÑ‡"});
Translation.addTranslation("Cobalt shovel", {ru: "ÐšÐ¾Ð±Ð°Ð»ÑŒÑ‚Ð¾Ð²Ð°Ñ Ð»Ð¾Ð¿Ð°Ñ‚Ð°"});

Translation.addTranslation("Dirium axe", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ñ‹Ð¹ Ñ‚Ð¾Ð¿Ð¾Ñ€"});
Translation.addTranslation("Dirium pickaxe", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð°Ñ ÐºÐ¸Ñ€ÐºÐ°"});
Translation.addTranslation("Dirium sword", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ñ‹Ð¹ Ð¼ÐµÑ‡"});
Translation.addTranslation("Dirium shovel", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð°Ñ Ð»Ð¾Ð¿Ð°Ñ‚Ð°"});
Translation.addTranslation("Dirium hammer", {ru: "Ð”Ð¸Ñ€ÑƒÐ¼Ð¾Ð²Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ñ‚"});
Translation.addTranslation("Dirium file", {ru: "Ð”Ð¸Ñ€ÑƒÐ¼Ð¾Ð²Ñ‹Ð¹ Ð½Ð°Ð¿Ð¸Ð»ÑŒÐ½Ð¸Ðº"});

//CHUNKS

Translation.addTranslation("Copper oreChunk", {ru: "ÐœÐµÐ´Ð½Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Tin oreChunk", {ru: "ÐžÐ»Ð¾Ð²ÑÐ½Ð½Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Iron oreChunk", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Cobalt oreChunk", {ru: "ÐšÐ¾Ð±Ð¾Ð»ÑŒÑ‚Ð¾Ð²Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Gold oreChunk", {ru: "Ð—Ð¾Ð»Ð¾Ñ‚Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Diamond oreChunk", {ru: "ÐÐ»Ð¼Ð°Ð·Ð½Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Redstone oreChunk", {ru: "Ð“Ð»Ñ‹Ð±Ð° ÐºÑ€Ð°ÑÐ½Ð¾Ð¹ Ð¿Ñ‹Ð»Ð¸"});
Translation.addTranslation("Dirium oreChunk", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð° Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Lapis oreChunk", {ru: "Ð›Ð°Ð·ÑƒÑ€Ð½Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Emerald oreChunk", {ru: "Ð˜Ð·ÑƒÐ¼Ñ€ÑƒÐ´Ð½Ð°Ñ Ð³Ð»Ñ‹Ð±Ð°"});
Translation.addTranslation("Downiron oreChunk", {ru: "Ð“Ð»Ñ‹Ð±Ð° ÐºÐ¾Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¶ÐµÐ»ÐµÐ·Ð°"});


//INGOTS

Translation.addTranslation("Copper ingot", {ru: "ÐœÐµÐ´Ð½Ñ‹Ð¹ ÑÐ»Ð¸Ñ‚Ð¾Ðº"});
Translation.addTranslation("Tin ingot", {ru: "ÐžÐ»Ð¾Ð²ÑÐ½Ð½Ñ‹Ð¹ ÑÐ»Ð¸Ñ‚Ð¾Ðº"});
Translation.addTranslation("Iron ingot", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ ÑÐ»Ð¸Ñ‚Ð¾Ðº"});
Translation.addTranslation("Cobalt ingot", {ru: "ÐšÐ¾Ð±Ð¾Ð»ÑŒÑ‚Ð¾Ð²Ñ‹Ð¹ ÑÐ»Ð¸Ñ‚Ð¾Ðº"});
Translation.addTranslation("Gold ingot", {ru: "Ð—Ð¾Ð»Ð¾Ñ‚Ð¾Ð¹ ÑÐ»Ð¸Ñ‚Ð¾Ðº"});
Translation.addTranslation("Dirium ingot", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð°Ñ ÑÐ»Ð¸Ñ‚Ð¾Ðº"});
Translation.addTranslation("Downiron ingot", {ru: "Ð¡Ð»Ð¸Ñ‚Ð¾Ðº ÐºÐ¾Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¶ÐµÐ»ÐµÐ·Ð°"});

//PLATES

Translation.addTranslation("Copper plate", {ru: "ÐœÐµÐ´Ð½Ð°Ñ Ð¿Ð»Ð¸Ñ‚Ð°"});
Translation.addTranslation("Tin plate", {ru: "ÐžÐ»Ð¾Ð²ÑÐ½Ð½Ð°Ñ Ð¿Ð»Ð¸Ñ‚Ð°"});
Translation.addTranslation("Iron plate", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð°Ñ Ð¿Ð»Ð¸Ñ‚Ð°"});
Translation.addTranslation("Cobalt plate", {ru: "ÐšÐ¾Ð±Ð¾Ð»ÑŒÑ‚Ð¾Ð²Ð°Ñ Ð¿Ð»Ð¸Ñ‚Ð°"});
Translation.addTranslation("Gold plate", {ru: "Ð—Ð¾Ð»Ð¾Ñ‚Ð°Ñ Ð¿Ð»Ð¸Ñ‚Ð°"});
Translation.addTranslation("Dirium plate", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð°Ñ Ð¿Ð»Ð¸Ñ‚Ð°"});
Translation.addTranslation("Downiron plate", {ru: "ÐŸÐ»Ð¸Ñ‚Ð° ÐºÐ¾Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¶ÐµÐ»ÐµÐ·Ð°"});

//DUSTS

Translation.addTranslation("Copper dust", {ru: "ÐœÐµÐ´Ð½Ð°Ñ Ð¿Ñ‹Ð»ÑŒ"});
Translation.addTranslation("Tin dust", {ru: "ÐžÐ»Ð¾Ð²ÑÐ½Ð½Ð°Ñ Ð¿Ñ‹Ð»ÑŒ"});
Translation.addTranslation("Iron dust", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð°Ñ Ð¿Ñ‹Ð»ÑŒ"});
Translation.addTranslation("Cobalt dust", {ru: "ÐšÐ¾Ð±Ð¾Ð»ÑŒÑ‚Ð¾Ð²Ð°Ñ Ð¿Ñ‹Ð»ÑŒ"});
Translation.addTranslation("Gold dust", {ru: "Ð—Ð¾Ð»Ð¾Ñ‚Ð°Ñ Ð¿Ñ‹Ð»ÑŒ"});
Translation.addTranslation("Dirium dust", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð°Ñ Ð¿Ñ‹Ð»ÑŒ"});
Translation.addTranslation("Downiron dust", {ru: "ÐŸÑ‹Ð»ÑŒ ÐºÐ¾Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¶ÐµÐ»ÐµÐ·Ð°"});

//BINDINGS

Translation.addTranslation("Dirium binding", {ru: "Ð”Ð¸Ñ€Ð¸ÑƒÐ¼Ð¾Ð²Ð¾Ðµ ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ"});
Translation.addTranslation("Iron binding", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð¾Ðµ ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ"});
Translation.addTranslation("Cobalt binding", {ru: "ÐšÐ¾Ð±Ð¾Ð»ÑŒÑ‚Ð¾Ð²Ð¾Ðµ ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ"});

//BARKS

Translation.addTranslation("Bark oak", {ru: "Ð”ÑƒÐ±Ð¾Ð²Ð°Ñ ÐºÐ¾Ñ€Ð°"});
Translation.addTranslation("Bark spruce", {ru: "Ð¡Ð¾ÑÐ½Ð¾Ð²Ð°Ñ ÐºÐ¾Ñ€Ð°"});
Translation.addTranslation("Bark birch", {ru: "Ð‘ÐµÑ€ÐµÐ·Ð¾Ð²Ð°Ñ ÐºÐ¾Ñ€Ð°"});
Translation.addTranslation("Bark jungle", {ru: "ÐšÐ¾Ñ€Ð° Ñ‚Ñ€Ð¾Ð¿Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð´ÐµÑ€ÐµÐ²Ð°"});
Translation.addTranslation("Bark acacia", {ru: "ÐšÐ¾Ñ€Ð° Ð°ÐºÑ†Ð¸Ð¸"});
Translation.addTranslation("Bark dark", {ru: "ÐšÐ¾Ñ€Ð° Ñ‚Ñ‘Ð¼Ð½Ð¾Ð³Ð¾ Ð´ÑƒÐ±Ð°"});

//ROCKS

Translation.addTranslation("Rock", {ru: "ÐšÐ°Ð¼ÐµÐ½ÑŒ"});
Translation.addTranslation("Granite rock", {ru: "Ð“Ñ€Ð°Ð½Ð¸Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¾ÑÐºÐ¾Ð»Ð¾Ðº"});
Translation.addTranslation("Diorite rock", {ru: "Ð”Ð¸Ð¾Ñ€Ð¸Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¾ÑÐºÐ¾Ð»Ð¾Ðº"});
Translation.addTranslation("Andesite rock", {ru: "ÐÐ½Ð´ÐµÐ·Ð¸Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¾ÑÐºÐ¾Ð»Ð¾Ðº"});

//OTHER

Translation.addTranslation("Fire bow", {ru: "ÐžÐ³Ð½ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ð»ÑƒÐ³"});
Translation.addTranslation("Flaked flint", {ru: "ÐžÑ‚Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ñ‹Ð¹ ÐºÑ€ÐµÐ¼ÐµÐ½ÑŒ"});
Translation.addTranslation("Plant fiber", {ru: "Ð Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð²Ð¾Ð»Ð¾ÐºÐ½Ð¾"});
Translation.addTranslation("Plant fiber rope", {ru: "Ð’ÐµÑ€ÐµÐ²ÐºÐ° Ð¸Ð· Ñ€Ð°ÑÑ‚Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¾Ð»Ð¾ÐºÐ½Ð°"});
Translation.addTranslation("Sawdust", {ru: "ÐžÐ¿Ð¸Ð»ÐºÐ¸"});

//BLOCKS

Translation.addTranslation("Gearbox", {ru: "ÐšÐ¾Ñ€Ð¾Ð±ÐºÐ° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡"});
Translation.addTranslation("Axle", {ru: "ÐšÐ¸Ð½ÐµÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÑ‚ÐµÑ€Ð¶ÐµÐ½ÑŒ"});
Translation.addTranslation("Watermill", {ru: "Ð’Ð¾Ð´ÑÐ½Ð¾Ðµ ÐºÐ¾Ð»ÐµÑÐ¾"});
Translation.addTranslation("Gearbox", {ru: "ÐšÐ¾Ñ€Ð¾Ð±ÐºÐ° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡"});
Translation.addTranslation("Grindmill", {ru: "ÐšÐ¸Ð½ÐµÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð´Ñ€Ð¾Ð±Ð¸Ñ‚ÐµÐ»ÑŒ"});

Translation.addTranslation("Machine casing", {ru: "ÐœÐ°ÑˆÐ¸Ð½Ð½Ñ‹Ð¹ Ð±Ð»Ð¾Ðº"});
Translation.addTranslation("Downiron machine casing", {ru: "ÐœÐ°ÑˆÐ¸Ð½Ð½Ñ‹Ð¹ Ð±Ð»Ð¾Ðº Ð¸Ð· ÐºÐ¾Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¶ÐµÐ»ÐµÐ·Ð°"});
Translation.addTranslation("Grinder", {ru: "Ð”Ñ€Ð¾Ð±Ð¸Ñ‚ÐµÐ»ÑŒ"});
Translation.addTranslation("Wire", {ru: "ÐŸÑ€Ð¾Ð²Ð¾Ð´"});
Translation.addTranslation("Kiln", {ru: "ÐŸÐµÑ‡ÑŒ"});
Translation.addTranslation("Unfired kiln", {ru: "ÐÐµÐ¾Ð±Ð¾Ð¶ÐµÐ½Ð½Ð°Ñ Ð¿Ð¾Ð»ÑÐºÐ°Ñ Ð¿ÐµÑ‡ÑŒ"});
Translation.addTranslation("Electrical kiln", {ru: "Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾-Ð¿ÐµÑ‡ÑŒ"});
Translation.addTranslation("Primal generator", {ru: "ÐŸÑ€Ð¸Ð¼Ð¸Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð³ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€"});
Translation.addTranslation("Survivalist crafting table", {ru: "Ð’ÐµÑ€ÑÑ‚Ð°Ðº Ð²Ñ‹Ð¶Ð¸Ð²Ð°ÑŽÑ‰ÐµÐ³Ð¾"});
Translation.addTranslation("Recipes table", {ru: "ÐŸÐ¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº Ð¿Ð¾ Ñ€ÐµÑ†ÐµÐ¿Ñ‚Ð°Ð¼"});
Translation.addTranslation("Haft", {ru: "Ð”ÐµÑ€ÐµÐ²ÑÐ½Ð½Ñ‹Ð¹ ÑÑ‚ÐµÑ€Ð¶ÐµÐ½ÑŒ"});
Translation.addTranslation("Recipes table", {ru: "ÐŸÐ¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº Ð¿Ð¾ Ñ€ÐµÑ†ÐµÐ¿Ñ‚Ð°Ð¼"});
Translation.addTranslation("Kiln bricks", {ru: "ÐŸÐµÑÑ‡Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¸Ñ€Ð¿Ð¸Ñ‡Ð¸"});
Translation.addTranslation("Alloy kiln", {ru: "ÐŸÐ»Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ Ð¿ÐµÑ‡ÑŒ"});
Translation.addTranslation("RedIron circuit", {ru: "ÐšÑ€Ð°ÑÐ½Ð°Ñ ÑÑ…ÐµÐ¼Ð°"});
Translation.addTranslation("Electronic motor", {ru: "Ð­Ð»ÐµÐºÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð¾Ñ‚Ð¾Ñ€Ñ‡Ð¸Ðº"});
Translation.addTranslation("Electronic piston", {ru: "Ð­Ð»ÐµÐºÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ñ€ÑˆÐµÐ½ÑŒ"});
Translation.addTranslation("Primal anvil", {ru: "ÐšÐ°Ð¼ÐµÐ½Ð½Ð°Ñ Ð½Ð°ÐºÐ¾Ð²Ð°Ð»ÑŒÐ½Ñ"});
Translation.addTranslation("Iron anvil", {ru: "Ð–ÐµÐ»ÐµÐ·Ð½Ð°Ñ Ð½Ð°ÐºÐ¾Ð²Ð°Ð»ÑŒÐ½Ñ"});




// file: api/tool_builder.js

importLib("ToolType","*");
importLib("SoundAPI","*");

Item.breakCarried = function(val){
  if(!val){
    val=1;
  }
    let item = Player.getCarriedItem();
  if(Item.getMaxDamage(item.id)){
    Player.setCarriedItem(item.id, item.count, item.data+val);
  }
  if(item.data>=Item.getMaxDamage(item.id)){
    Player.decreaseCarriedItem(item.count);
  }
};

const anyDamage = function(id){
    for(i=0;i<Item.getMaxDamage(id);i++){
      return i;
  }
};


ToolType.workblade = {
	isWeapon: true,
	damage: 3,
	baseDamage: 4,
	blockTypes: ["fiber", "plant"],
	onDestroy: function(item){
    item.data++;
  },
  onBroke: function(item){item.id=item.count=item.data=0},
  calcDestroyTime: function(item, coords, block, params, destroyTime, enchant){
    if(block.id==18||block.id==161){
      return 0;
    }
  },
  onAttack: function(item, mob){
    item.data++;
  }
};

var ToolBuilder = {
  material: {},
  addMaterial: function(name,data,lvl,eff,dam){
    ToolAPI.addToolMaterial(name, {durability: data, level: lvl, efficiency: eff, damage: dam});
  },
  createAxe: function(arg){
    IDRegistry.genItemID("axe"+arg.material);
    Item.createItem("axe"+arg.material, arg.material+" axe", {name: "axe"+arg.material, meta: 0}, {stack: 1});
    ToolAPI.setTool(ItemID["axe"+arg.material],arg.material,ToolType.axe);
  },
  createPickaxe: function(arg){
    IDRegistry.genItemID("pickaxe"+arg.material);
    Item.createItem("pickaxe"+arg.material, arg.material+" pickaxe", {name: "pickaxe"+arg.material, meta: 0}, {stack: 1});
    ToolAPI.setTool(ItemID["pickaxe"+arg.material],arg.material,ToolType.pickaxe);
  },
  createShovel: function(arg){
    IDRegistry.genItemID("shovel"+arg.material);
    Item.createItem("shovel"+arg.material, arg.material+" shovel", {name: "shovel"+arg.material, meta: 0}, {stack: 1});
    ToolAPI.setTool(ItemID["shovel"+arg.material],arg.material,ToolType.shovel);
  },
  createWorkblade: function(arg){
    IDRegistry.genItemID("workblade"+arg.material);
    Item.createItem("workblade"+arg.material, arg.material+" workblade", {name: "workblade"+arg.material, meta: 0}, {stack: 1});
    ToolAPI.setTool(ItemID["workblade"+arg.material],arg.material,ToolType.workblade);
  },
  createSword: function(arg){
    IDRegistry.genItemID("sword"+arg.material);
    Item.createItem("sword"+arg.material, arg.material+" sword", {name: "sword"+arg.material, meta: 0}, {stack: 1});
    ToolAPI.setTool(ItemID["sword"+arg.material],arg.material,ToolType.sword);
  },
  createHoe: function(arg){
    IDRegistry.genItemID("hoe"+arg.material);
    Item.createItem("hoe"+arg.material, arg.material+" hoe", {name: "hoe"+arg.material, meta: 0}, {stack: 1});
    ToolAPI.setTool(ItemID["hoe"+arg.material],arg.material,ToolType.hoe);
  }
};
ToolBuilder.addMaterial("Stone", 66, 2, 2, 3);
ToolBuilder.createAxe({material: "Stone"});
ToolBuilder.createPickaxe({material: "Stone"});

ToolBuilder.addMaterial("Flint", 83, 2, 2, 3);
ToolBuilder.createAxe({material: "Flint"});
ToolBuilder.createPickaxe({material: "Flint"});
ToolBuilder.createShovel({material: "Flint"});
ToolBuilder.createWorkblade({material: "Flint"});
ToolBuilder.createHoe({material: "Flint"});

ToolBuilder.addMaterial("Iron", 340, 3, 4, 6);
ToolBuilder.createAxe({material: "Iron"});
ToolBuilder.createPickaxe({material: "Iron"});
ToolBuilder.createShovel({material: "Iron"});
ToolBuilder.createSword({material: "Iron"});
ToolBuilder.createHoe({material: "Iron"});

ToolBuilder.addMaterial("Cobalt", 890, 5, 7, 7);
ToolBuilder.createAxe({material: "Cobalt"});
ToolBuilder.createPickaxe({material: "Cobalt"});
ToolBuilder.createShovel({material: "Cobalt"});
ToolBuilder.createSword({material: "Cobalt"});
ToolBuilder.createHoe({material: "Cobalt"});

ToolBuilder.addMaterial("Dirium", 1250, 5, 8, 8);
ToolBuilder.createAxe({material: "Dirium"});
ToolBuilder.createPickaxe({material: "Dirium"});
ToolBuilder.createShovel({material: "Dirium"});
ToolBuilder.createSword({material: "Dirium"});
ToolBuilder.createHoe({material: "Dirium"});




// file: api/recipes_system.js

var rnd = function(min, max){
  return Math.floor((Math.random()*max)+min);
};


var RecipeSystem = {
  workbench: [],
  kiln: [],
  anvil: [],
  grinder: {},
    addRecipeToWorkbench: function(resId,resCount,resData,ing,tool,canDamage,level,code){
        if(!tool) tool=0; 
        if(!canDamage) canDamage=true;
        if(!level) level=0;
        this.workbench.push({resId:resId,resCount:resCount,resData:resData,
          ing0: ing[0][0], ingData0: ing[0][1],
          ing1: ing[1][0], ingData1: ing[1][1],
          ing2: ing[2][0], ingData2: ing[2][1],
          ing3: ing[3][0], ingData3: ing[3][1],
          ing4: ing[4][0], ingData4: ing[4][1],
          ing5: ing[5][0], ingData5: ing[5][1],
          ing6: ing[6][0], ingData6: ing[6][1],
          ing7: ing[7][0], ingData7: ing[7][1],
          ing8: ing[8][0], ingData8: ing[8][1],
          toolId: tool, canDamage: canDamage, level: level, code: code
        });
    },
    getWorkbenchRecipe: function(){
        return this.workbench;
    },
    addRecipeToKiln: function(resId,resCount,resData,ing){
        this.kiln.push({resId:resId,resCount:resCount,resData:resData,
            ing0: ing[0][0], ingCount0: ing[0][1], ingData0: ing[0][2], 
            ing1: ing[1][0], ingCount1: ing[1][1], ingData1: ing[1][2]
        });
    },
    getKilnRecipe: function(){
        return this.kiln;
    },
    addAnvilRecipe: function(res,item,tool){
      this.anvil.push({resId: res.id, resCount: res.count, resData: res.data, item: item, tool:tool});
    },
    getAnvilRecipe: function(){
      return this.anvil;
    },
    addGrinderRecipe: function(ing,res){
      this.grinder[ing.id+":"+ing.data]={id:res.id,data:res.data,count:res.count}
    },
    getGrinderRecipe: function(id,data){
      return this.grinder[id+":"+data];
    }
};

var RecipePattern = {
  metalBlock: function(res,ing){
    RecipeSystem.addRecipeToWorkbench(res.id,1,res.data,[
      [ing.id,ing.data] , [ing.id,ing.data] , [ing.id,ing.data] ,
      [ing.id,ing.data] , [ing.id,ing.data] , [ing.id,ing.data] ,
      [ing.id,ing.data] , [ing.id,ing.data] , [ing.id,ing.data] ,
    ]);
    RecipeSystem.addRecipeToWorkbench(ing.id,9,ing.data,[
      [res.id,res.data] , [0,0] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
    ]); 
  },
  smallRecipe: function(res,ing){
    RecipeSystem.addRecipeToWorkbench(res.id,1,res.data,[
      [ing.id,ing.data] , [ing.id,ing.data] , [0,0] ,
      [ing.id,ing.data] , [ing.id,ing.data] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
    ]);
    RecipeSystem.addRecipeToWorkbench(ing.id,4,ing.data,[
      [res.id,res.data] , [0,0] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
    ]); 
  },
  withToolRecipe: function(res,ing,tool,canDamage){
  if(canDamage==null){canDamage=true;}
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [ing.id,ing.data] , [0,0] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
      [0,0] , [0,0] , [0,0] ,
    ],tool, canDamage);
  },
  pickaxeRecipe: function(res,ing){
  for(i in craftingFiles){
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [ing.plate,0] , [ing.ingot,0] , [ing.ingot,0] ,
      [0,0] , [ing.binding,0] , [0,0] ,
      [0,0] , [280,0] , [0,0] ,
    ],craftingFiles[i]);}
  },
  axeRecipe: function(res,ing){
  for(i in craftingFiles){
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [ing.plate,0] , [ing.ingot,0] , [ing.binding,0] ,
      [ing.plate,0] , [280,0] , [ing.ingot,0] ,
      [0,0] , [280,0] , [0,0] ,
    ],craftingFiles[i]);}
  },
  shovelRecipe: function(res,ing){
  for(i in craftingFiles){
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [0,0] , [ing.plate,0] , [ing.binding,0] ,
      [0,0] , [280,0] , [ing.plate,0] ,
      [280,0] , [0,0] , [0,0] ,
    ],craftingFiles[i]);}
  },
  swordRecipe: function(res,ing){
  for(i in craftingFiles){
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [0,0] , [ing.plate,0] , [ing.plate,0] ,
      [ing.plate,0] , [ing.binding,0] , [ing.plate,0] ,
      [280,0] , [ing.plate,0] , [0,0] ,
    ],craftingFiles[i]);}
  },
  hoeRecipe: function(res,ing){
  for(i in craftingFiles){
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [ing.plate,0] , [ing.binding,0] , [0,0] ,
      [0,0] , [280,0] , [0,0] ,
      [0,0] , [280,0] , [0,0] ,
    ],craftingFiles[i]);}
  },
  helmetRecipe: function(res,ing){
  for(i in craftingHammers){
    RecipeSystem.addRecipeToWorkbench(res.id,res.count,res.data,[
      [ing.ingot,0] , [ing.plate,0] , [ing.ingot,0] ,
      [ing.plate,0] , [0,0] , [ing.plate,0] ,
      [0,0] , [ItemID.leatherBelt,0] , [0,0] ,
    ],craftingHammers[i]);}
  }
};

Callback.addCallback("PostLoaded", function(){

for(let d = 0;d<=3;d++){

RecipeSystem.addRecipeToWorkbench(5,6,d,[
    [17,d],[0,0],[0,0],
    [0,0],[0,0],[0,0],
    [0,0],[0,0],[0,0],
],ItemID.axeFlint, true, 0, function(){
    World.drop(this.x,this.y+1,this.z,ItemID.bark_oak,1,0);
  });

}

for(let d = 0;d<=1;d++){
RecipeSystem.addRecipeToWorkbench(5,6,d,[
    [162,d],[0,0],[0,0],
    [0,0],[0,0],[0,0],
    [0,0],[0,0],[0,0],
],ItemID.axeFlint);}

RecipeSystem.addRecipeToWorkbench(ItemID.pickaxeFlint,1,0,[
    [318,0],[ItemID.plantRope,0],[318,0],
    [ItemID.flakedFlint,0],[280,0],[ItemID.flakedFlint ,0], 
    [0,0],[280,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.workbladeFlint,1,0,[
    [0,0],[ItemID.flakedFlint,0],[318,0],
    [ItemID.flakedFlint,0],[ItemID.plantRope,0],[ItemID.flakedFlint ,0], 
    [280,0],[ItemID.flakedFlint,0],[0,0]
],0);

RecipePattern.metalBlock({id:41,data:0},{id:266,data:0});
RecipePattern.metalBlock({id:42,data:0},{id:265,data:0});
RecipePattern.metalBlock({id:57,data:0},{id:264,data:0});
RecipePattern.metalBlock({id:152,data:0},{id:331,data:0});
RecipePattern.metalBlock({id:133,data:0},{id:388,data:0});
RecipePattern.metalBlock({id:22,data:0},{id:351,data:4});


RecipeSystem.addRecipeToWorkbench(ItemID.axeFlint,1,0,[
    [ItemID.flakedFlint,0],[318,0],[ItemID.plantRope,0],
    [ItemID.flakedFlint,0],[280,0],[ItemID.flakedFlint,0], 
    [0,0],[280,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.shovelFlint,1,0,[
    [0,0],[ItemID.flakedFlint,0],[318,0],
    [0,0],[ItemID.plantRope,0],[ItemID.flakedFlint,0], 
    [280,0],[0,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.plantRope,1,0,[
    [ItemID.plantFiber,0],[ItemID.plantFiber,0],[0,0],
    [ItemID.plantFiber,0],[ItemID.plantFiber,0],[0,0], 
    [0,0],[0,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(4,1,0,[
    [ItemID.rockStone,0],[ItemID.rockStone,0],[0,0],
    [ItemID.rockStone,0],[ItemID.rockStone,0],[0,0], 
    [0,0],[0,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(BlockID.kilnBricks,2,0,[
    [337,0],[24,0],[337,0],
    [24,0],[337,0],[24,0], 
    [337,0],[24,0],[337,0]
],0);

RecipeSystem.addRecipeToWorkbench(BlockID.alloyKilnController,1,0,[
    [ BlockID.kilnBricks ,0],[ BlockID.kilnBricks ,0],[ BlockID.kilnBricks ,0],
    [ BlockID.kilnBricks ,0],         [0,0],          [ BlockID.kilnBricks ,0], 
    [ BlockID.kilnBricks ,0],[ BlockID.kilnBricks ,0],[ BlockID.kilnBricks ,0]
],0);


});


var Fuel = {
    getBurnTime: function(id,data){
        return Recipes.getFuelBurnDuration(id,data);
    }
};



Callback.addCallback("PostLoaded", function(){
  for(d=0;d<4;d++){
  RecipeSystem.addRecipeToKiln(263,2,1,[[17,1,d],[17,1,d]]);}
  RecipeSystem.addRecipeToKiln(263,2,1,[[161,1,0],[161,1,0]]);
  RecipeSystem.addRecipeToKiln(263,2,1,[[161,1,1],[161,1,1]]);
  RecipeSystem.addRecipeToKiln(20,1,0,[[12,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(20,2,0,[[12,1,0],[12,1,0]]);
  RecipeSystem.addRecipeToKiln(20,1,0,[[12,1,1],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(20,2,0,[[12,1,1],[12,1,1]]);
  RecipeSystem.addRecipeToKiln(ItemID.ingotDirium,1,0,[[ItemID.dustDirium,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(ItemID.ingotDowniron,1,0,[[ItemID.dustDowniron,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(ItemID.ingotCobalt,1,0,[[ItemID.dustCobalt,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(ItemID.ingotCopper,1,0,[[ItemID.dustCopper,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(265,1,0,[[ItemID.dustIron,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(266,1,0,[[ItemID.dustGold,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(ItemID.ingotTin,1,0,[[ItemID.dustTin,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(1,2,0,[[4,1,0],[4,1,0]]);
  RecipeSystem.addRecipeToKiln(1,1,0,[[4,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(350,1,0,[[349,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(350,1,1,[[349,1,1],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(364,1,0,[[363,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(366,1,0,[[365,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(393,1,0,[[392,1,0],[0,0,0]]);
  RecipeSystem.addRecipeToKiln(320,1,0,[[319,1,0],[0,0,0]]);
});





// file: world/hard_start.js

//Rocks from stones
IDRegistry.genItemID("rockStone");
Item.createItem("rockStone", "Rock", {name: "rock_stone"}, {stack: 64});
IDRegistry.genItemID("rockGranite");
Item.createItem("rockGranite", "Rock granite", {name: "rock_granite"}, {stack: 64});
IDRegistry.genItemID("rockDiorite");
Item.createItem("rockDiorite", "Rock diorite", {name: "rock_diorite"}, {stack: 64});
IDRegistry.genItemID("rockAndesite");
Item.createItem("rockAndesite", "Rock andesite", {name: "rock_andesite"}, {stack: 64});

var rndInt = function(max){
  return max;
}

Block.registerDropFunction(1, function(coords, blockID, data, level, enchant){
		if(level>0){
			if(data==0){
			  return [[ItemID.rockStone, rndInt(3) ,0]];
			}
			if(data==1){
			  return [[ItemID.rockGranite, rndInt(3) ,0]];
			}
     if(data==3){
			  return [[ItemID.rockDiorite, rndInt(3) ,0]];
		  }
     if(data==5){
        return [[ItemID.rockAndesite, rndInt(3) ,0]];
		  }
   }
});


IDRegistry.genItemID("flakedFlint");
Item.createItem("flakedFlint", "Flaked flint", {name: "flaked_flint"}, {stack: 64});
IDRegistry.genItemID("plantFiber");
Item.createItem("plantFiber", "Plant fiber", {name: "plant_fiber"}, {stack: 64});
IDRegistry.genItemID("plantRope");
Item.createItem("plantRope", "Plant fiber rope", {name: "plant_rope"}, {stack: 64});
IDRegistry.genItemID("sawdust");
Item.createItem("sawdust", "Sawdust", {name: "sawdust"}, {stack: 64});

Item.defineItemss = function(id,name,types){
  for(i in types){
    IDRegistry.genItemID(id+"_"+types[i]);
    Item.createItem(id+"_"+types[i], name+" "+types[i], {name: id+"_"+types[i]}, {stack: 64});
  }
};

Item.defineItemss("bark","Bark",["oak","spruce","birch","jungle","dark","acacia"]);

Block.registerDropFunction(17, function(coords, blockID, data, level, enchant){
  if(level==0){
	   if(Math.random()<=0.3){
		    return [[ItemID.haft,1,0]];
		  } else return [[ItemID.bark_oak,1,0], [ItemID.sawdust,1,0], [5,2,data]];
  }
});

Block.registerDropFunction(162, function(coords, blockID, data, level, enchant){
		if(level==0){
			  return [[ItemID.bark_oak,1,0], [ItemID.sawdust,1,0], [5,2,data]];
   }
});


Block.registerPlaceFunction(58, function(coords){
  Game.prevent();
  var c = coords.relative;
  World.setBlock(c.x,c.y,c.z,BlockID.survivalistCraftingTable);
});

Callback.addCallback("ItemUse", function(crd){
  item = Player.getCarriedItem();
    if(item.id==318 && World.getBlockID(crd.x,crd.y,crd.z) == 1){
      if(Math.random() < 0.3){
      Player.addItemToInventory(ItemID.flakedFlint,1,0);
      Player.decreaseCarriedItem(1);
    }
  }
});


Block.registerDropFunction(2, function(coords, blockID, data, level, enchant){
  return [[3,1,0]];
    if( Math.random()*1 < 0.5 ){
      return [[3,1,0],[ItemID.plantFiber,1,0]];
    }
});

Block.registerDropFunction(13, function(coords, blockID, data, level, enchant){
    if( Math.random()*1 < 0.4 ){
      return [[318,1,0]];
    }else{ return [[blockID,1,data]]; 
  }
});

Block.registerDropFunction(31, function(coords, blockID, data, level, enchant){
    if( Math.random()*1 < 0.7 ){
      return [[ItemID.plantFiber,1,0]];
    }
});

Block.registerDropFunction(18, function(coords, blockID, data, level, enchant){
    if( Math.random()*1 < 0.6 ){
      return [[280,1,0]];
    }
});

//More cobblestone


IDRegistry.genBlockID("cobbleDiorite");
Block.createBlock("cobbleDiorite", [
	{name: "Diorite cobblestone", texture: [
	["cobblestone_diorite",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.cobbleDiorite,4);
ToolAPI.registerBlockMaterial(BlockID.cobbleDiorite, "stone", 1, true);

IDRegistry.genBlockID("cobbleAndesite");
Block.createBlock("cobbleAndesite", [
	{name: "Andesite cobblestone", texture: [
	["cobblestone_andesite",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.cobbleAndesite,4);
ToolAPI.registerBlockMaterial(BlockID.cobbleAndesite, "stone", 1, true);

IDRegistry.genBlockID("cobbleGranite");
Block.createBlock("cobbleGranite", [
	{name: "Granite cobblestone", texture: [
	["cobblestone_granite",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.cobbleGranite,4);
ToolAPI.registerBlockMaterial(BlockID.cobbleGranite, "stone", 1, true);

IDRegistry.genBlockID("oreDirium");
Block.createBlock("oreDirium", [
	{name: "Dirium ore", texture: [
	["dirium_ore",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.oreDirium,4);
ToolAPI.registerBlockMaterial(BlockID.oreDirium, "stone", 3, true);

Callback.addCallback("GenerateChunkUnderground", function(chunkX, chunkZ){
  let coords = GenerationUtils.randomCoords(chunkX, chunkZ, 1, 16);
    if(rnd(1,5)==1&&World.getBlockID(coords.x,coords.y,coords.z)===1){
	    for(var i = 0; i < 16; i++){
		    GenerationUtils.generateOre(coords.x, coords.y, coords.z, BlockID.oreDirium, 0, rnd(1,7));
		  }
 	 }
});

IDRegistry.genBlockID("oreDowniron");
Block.createBlock("oreDowniron", [
	{name: "Downiron ore", texture: [
	["downiron_ore",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.oreDowniron,14);
ToolAPI.registerBlockMaterial(BlockID.oreDowniron, "stone", 3, true);

Callback.addCallback("GenerateChunkUnderground", function(chunkX, chunkZ){
	let coords = GenerationUtils.randomCoords(chunkX, chunkZ, 1, 6);
	  for(var i = 0; i < rnd(20,30); i++){
	    if(World.getBlockID(coords.x,coords.y,coords.z)===1){
		    GenerationUtils.generateOre(coords.x, coords.y, coords.z, BlockID.oreDowniron, 0);
		  }
		}
	});

IDRegistry.genBlockID("oreTin");
Block.createBlock("oreTin", [
	{name: "Tin ore", texture: [
	["tin_ore",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.oreTin,4);
ToolAPI.registerBlockMaterial(BlockID.oreTin, "stone", 2, true);

Callback.addCallback("GenerateChunkUnderground", function(chunkX, chunkZ){
	let coords = GenerationUtils.randomCoords(chunkX, chunkZ, 1, 60);
	  for(var i = 0; i < rnd(20,30); i++){
	  if(World.getBlockID(coords.x,coords.y,coords.z)===1){
		    GenerationUtils.generateOre(coords.x, coords.y, coords.z, BlockID.oreTin, 0);
		  }
		}
});

IDRegistry.genBlockID("oreCobalt");
Block.createBlock("oreCobalt", [
	{name: "Cobalt ore", texture: [
	["cobalt_ore",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.oreCobalt,4);
ToolAPI.registerBlockMaterial(BlockID.oreCobalt, "stone", 2, true);

Callback.addCallback("GenerateChunkUnderground", function(chunkX, chunkZ){
	let coords = GenerationUtils.randomCoords(chunkX, chunkZ, 1, 30);
	if(rnd(1,4)==4){
	  for(var i = 0; i < 10; i++){
	    if(World.getBlockID(coords.x,coords.y,coords.z)===1){
		      GenerationUtils.generateOre(coords.x, coords.y, coords.z, BlockID.oreCobalt, 0);
		    }
		  }
		}
});

IDRegistry.genBlockID("oreCopper");
Block.createBlock("oreCopper", [
	{name: "Copper ore", texture: [
	["copper_ore",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.oreCopper,4);
ToolAPI.registerBlockMaterial(BlockID.oreCopper, "stone", 2, true);

Callback.addCallback("GenerateChunkUnderground", function(chunkX, chunkZ){
  let coords = GenerationUtils.randomCoords(chunkX, chunkZ, 32, 100);
	  for(var i = 0; i < rnd(20,30); i++){
	  if(World.getBlockID(coords.x,coords.y,coords.z)===1){
		    GenerationUtils.generateOre(coords.x, coords.y, coords.z, BlockID.oreCopper, 0, rnd(1,7), true);
		  }
		}
	});

Block.registerDropFunction(BlockID.oreCopper,function(coords,blockID,data,level,enchant){
  if(level>1){
    return [[ItemID.oreChunkCopper,rnd(1,2)]]
  }
});

Block.registerDropFunction(BlockID.oreTin,function(coords,blockID,data,level,enchant){
  if(level>1){
    return [[ItemID.oreChunkTin,rnd(1,2)]]
  }
});

Block.registerDropFunction(14,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkGold,rnd(1,2)]]
  }
});

Block.registerDropFunction(15,function(coords,blockID,data,level,enchant){
  if(level>1){
    return [[ItemID.oreChunkIron,rnd(1,2)]]
  }
});

Block.registerDropFunction(56,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkDiamond,1]]
  }
});

Block.registerDropFunction(73,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkRedstone,rnd(1,4)]]
  }
});

Block.registerDropFunction(74,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkRedstone,rnd(1,4)]]
  }
});

Block.registerDropFunction(BlockID.oreDowniron,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkDowniron,rnd(1,2)]]
  }
});

Block.registerDropFunction(21,function(coords,blockID,data,level,enchant){
  if(level>1){
    return [[ItemID.oreChunkLapis,rnd(1,4)]]
  }
});

Block.registerDropFunction(129,function(coords,blockID,data,level,enchant){
  if(level>1){
    return [[ItemID.oreChunkEmerald,rnd(1,2)]]
  }
});

Block.registerDropFunction(BlockID.oreCobalt,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkCobalt,rnd(1,2)]]
  }
});

Block.registerDropFunction(BlockID.oreDirium,function(coords,blockID,data,level,enchant){
  if(level>2){
    return [[ItemID.oreChunkDirium,rnd(1,2)]]
  }
});

Callback.addCallback("PostLoaded", function(){

RecipeSystem.addRecipeToWorkbench(BlockID.cobbleAndesite,1,0,[
    [ItemID.rockAndesite,0],[ItemID.rockAndesite,0],[0,0],
    [ItemID.rockAndesite,0],[ItemID.rockAndesite,0],[0,0], 
    [0,0],[0,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(BlockID.cobbleDiorite,1,0,[
    [ItemID.rockDiorite,0],[ItemID.rockDiorite,0],[0,0],
    [ItemID.rockDiorite,0],[ItemID.rockDiorite,0],[0,0], 
    [0,0],[0,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(BlockID.cobbleGranite,1,0,[
    [ItemID.rockGranite,0],[ItemID.rockGranite,0],[0,0],
    [ItemID.rockGranite,0],[ItemID.rockGranite,0],[0,0], 
    [0,0],[0,0],[0,0]
],0);

});

importLib("TreeAPI","*");




// file: world/tweaks.js

/*Block.setDestroyTime(1,9.91); Block.setDestroyTime(2,5.31); Block.setDestroyTime(3,5.1);//k
Block.setDestroyTime(4,10.23); Block.setDestroyTime(5,5.5); Block.setDestroyTime(17,6.2);//i
Block.setDestroyTime(18,.9); Block.setDestroyTime(14,10.2); Block.setDestroyTime(15,10.2);//l
Block.setDestroyTime(16,10.2); Block.setDestroyTime(20,0.5); Block.setDestroyTime(21,10.2);//l
Block.setDestroyTime(22,10.2); Block.setDestroyTime(56,10.2); Block.setDestroyTime(73,10.2);*/




// file: api/craft.js

IDRegistry.genBlockID("survivalistCraftingTable");
Block.createBlock("survivalistCraftingTable", [
	{name: "Survivalist crafting table", texture: [
	["sctSide",0],["sctTop",0],["sctSide", 0]], inCreative: true}
]);
Block.setBlockShape(BlockID.survivalistCraftingTable, {x: 0, y: 0, z: 0}, {x: 1, y: 0.4, z: 1});

var sctGUI = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Craft"}},
		inventory: {standart: true},
		background: {standart: true}
	},
		 	elements: {
		  "res": {type: "slot", x: 592+128, y: 100},
      "ing0": {type: "slot", x: 464, y: 100},
      "ing1": {type: "slot", x: 528, y: 100},
      "ing2": {type: "slot", x: 592, y: 100},
      "ing3": {type: "slot", x: 464, y: 164},
      "ing4": {type: "slot", x: 528, y: 164},
      "ing5": {type: "slot", x: 592, y: 164},
      "ing6": {type: "slot", x: 464, y: 228},
      "ing7": {type: "slot", x: 528, y: 228},
      "ing8": {type: "slot", x: 592, y: 228},
      "slotTool": {type: "slot", x: 592+64, y: 200, bitmap: "slotTool"},
		  "button": {type: "button", x: 592+64, y: 100, bitmap: "craftBtn_0",bitmap2: "craftBtn_1",scale: 3.2,
		clicker: {
			onClick: function(container, tileEntity){
				tileEntity.data.craft = true;}}
    }
  }
});

TileEntity.registerPrototype(BlockID.survivalistCraftingTable, {
    defaultValues: {
      craft: false
    },
    getGuiScreen: function(){
      return sctGUI;
    },
    tick: function(){
      let ing0 = this.container.getSlot("ing0");
      let ing1 = this.container.getSlot("ing1");
      let ing2 = this.container.getSlot("ing2");
      let ing3 = this.container.getSlot("ing3");
      let ing4 = this.container.getSlot("ing4");
      let ing5 = this.container.getSlot("ing5");
      let ing6 = this.container.getSlot("ing6");
      let ing7 = this.container.getSlot("ing7");
      let ing8 = this.container.getSlot("ing8");
      
      let tool = this.container.getSlot("slotTool");
      let res = this.container.getSlot("res");
      
      if(Item.getMaxDamage(tool.id)){
        if(tool.id!=0&&tool.data>Item.getMaxDamage(tool.id)){
          tool.id=0;tool.data=0;
        }
      }
      
      if(this.data.craft){
      let rec_ = RecipeSystem.getWorkbenchRecipe();
      
      for(i in rec_){
      let rec = rec_[i];
      
        if( ing0.id==rec.ing0 && ing0.data==rec.ingData0 && ing1.id==rec.ing1 && ing1.data==rec.ingData1 &&
            ing2.id==rec.ing2 && ing2.data==rec.ingData2 && ing3.id==rec.ing3 && ing3.data==rec.ingData3 &&
            ing4.id==rec.ing4 && ing4.data==rec.ingData4 && ing5.id==rec.ing5 && ing5.data==rec.ingData5 &&
            ing6.id==rec.ing6 && ing6.data==rec.ingData6 && ing7.id==rec.ing7 && ing7.data==rec.ingData7 &&
            ing8.id==rec.ing8 && ing8.data==rec.ingData8 &&
              tool.id==rec.toolId && ( res.id == 0 || res.id == rec.resId ) &&
              res.count+rec.resCount<=Item.getMaxStack( rec.resId, rec.resData && rec.level==0)
            ){
              ing0.count--; ing1.count--; ing2.count--;
              ing3.count--; ing4.count--; ing5.count--;
              ing6.count--; ing7.count--; ing8.count--;
              res.id=rec.resId; res.count+=rec.resCount; res.data=rec.resData; if(rec.canDamage) tool.data++; if(rec.code) code();
          }
      }
      this.container.validateAll();
      if(this.data.craft&&World.getThreadTime()%1==0){
        this.data.craft=false;
        this.container.validateAll();
      }
    }
  }
});




// file: others/items.js

Item.defineItems = function(id,types){
  for(i in types){
    IDRegistry.genItemID(id+types[i]);
    Item.createItem(id+types[i], types[i]+" "+id, {name: id+types[i], meta: 0}, {stack: 64});
  }
};

Item.defineItems("oreChunk",["Iron","Copper","Redstone","Cobalt","Lapis","Diamond","Gold","Dirium","Downiron","Tin","Emerald"]);
Item.defineItems("ingot",["Copper","Cobalt","Tin","Downiron","Cobalt","Dirium","Bronze"]);
Item.defineItems("plate",["Iron","Copper","Tin","Downiron","Dirium","Cobalt","Bronze"]);
Item.defineItems("dust",["Gold","Iron","Downiron","Dirium","Copper","Cobalt","Tin","Charcoal","Coal"]);
Item.defineItems("binding",["Iron","Cobalt","Dirium"]);

IDRegistry.genItemID("fireBow");
Item.createItem("fireBow", "Fire bow", {name: "fireBow", meta: 0}, {stack: 64});

IDRegistry.genItemID("circuitRedIron");
Item.createItem("circuitRedIron", "RedIron circuit", {name: "redstoneAndIronChip", meta: 0}, {stack: 64});

IDRegistry.genItemID("electronicMotor");
Item.createItem("electronicMotor", "Electronic motor", {name: "electronicMotor", meta: 0}, {stack: 64});

IDRegistry.genItemID("electronicPiston");
Item.createItem("electronicPiston", "Piston", {name: "electronicPiston", meta: 0}, {stack: 64});

IDRegistry.genItemID("alchemyStone");
Item.createItem("alchemyStone", "Alchemy stone", {name: "alchemyStone", meta: 0}, {stack: 99});



Item.setMaxDamage(ItemID.fireBow,5);

IDRegistry.genItemID("craftHammerStone");
Item.createItem("craftHammerStone", "Stone hammer", {name: "craftHammerStone", meta: 0}, {stack: 1});
IDRegistry.genItemID("craftHammerIron");
Item.createItem("craftHammerIron", "Iron hammer", {name: "craftHammerIron", meta: 0}, {stack: 1});
IDRegistry.genItemID("craftHammerBronze");
Item.createItem("craftHammerBronze", "Bronze hammer", {name: "craftHammerBronze", meta: 0}, {stack: 1});
IDRegistry.genItemID("craftHammerDirium");
Item.createItem("craftHammerDirium", "Dirium hammer", {name: "craftHammerDirium", meta: 0}, {stack: 1});

IDRegistry.genItemID("craftFileIron");
Item.createItem("craftFileIron", "Iron file", {name: "craftFileIron", meta: 0}, {stack: 1});

IDRegistry.genItemID("craftFileDirium");
Item.createItem("craftFileDirium", "Dirium file", {name: "craftFileDirium", meta: 0}, {stack: 1});

IDRegistry.genItemID("chestLatch");
Item.createItem("chestLatch", "Chest latch", {name: "chestLatch", meta: 0}, {stack: 16});

IDRegistry.genItemID("cuttedLeather");
Item.createItem("cuttedLeather", "Cutted leather", {name: "cuttedLeather", meta: 0}, {stack: 64});

IDRegistry.genItemID("leatherBelt");
Item.createItem("leatherBelt", "Leather belt", {name: "leatherBelt", meta: 0}, {stack: 64});

IDRegistry.genItemID("gearWooden");
Item.createItem("gearWooden", "Wooden gear", {name: "gearWooden", meta: 0}, {stack: 64});

RecipePattern.withToolRecipe({id:ItemID.cuttedLeather,count:1,data:0},{id:334,data:0},ItemID.workbladeFlint);

RecipePattern.withToolRecipe({id:ItemID.leatherBelt,count:3,data:0},{id:ItemID.cuttedLeather,data:0},ItemID.workbladeFlint);


Item.setMaxDamage(ItemID.craftHammerStone,26);
Item.setMaxDamage(ItemID.craftHammerIron,90);
Item.setMaxDamage(ItemID.craftHammerBronze,95);
Item.setMaxDamage(ItemID.craftHammerDirium,550);

Item.setMaxDamage(ItemID.craftFileIron,50);
Item.setMaxDamage(ItemID.craftFileDirium,450);

var craftingHammers = [ItemID.craftHammerIron, ItemID.craftHammerBronze, ItemID.craftHammerDirium,ItemID.craftHammerStone];
var craftingFiles = [ItemID.craftFileIron, ItemID.craftFileDirium];

Item.registerUseFunction("fireBow", function(coords,item,block){
    let plc = coords.relative;
    if(World.getBlockID(plc.x,plc.y,plc.z)==0&&item.data<5){
        World.setBlock(plc.x,plc.y,plc.z,51);
        Player.setCarriedItem(item.id,1,item.data+1);
    }
});

for(i in craftingHammers){
Item.registerUseFunction(craftingHammers[i], function(c,item,block){
  for(i in KineticMachine.machineIDs){
    if(World.getBlockID(c.x,c.y,c.z)==KineticMachine.machineIDs[i]){
      Game.tipMessage("Status: Work="+World.getTileEntity(c.x,c.y,c.z).data.work);
    }
  }
});}

Callback.addCallback("PostLoaded", function(){
RecipeSystem.addRecipeToWorkbench(ItemID.fireBow,1,0,[
    [ItemID.bark_oak,0],[280,0],[280,0],
    [280,0],[0,0],[ItemID.plantRope,0],
    [280,0],[ItemID.plantRope,0],[0,0],
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.gearWooden,1,0,[
    [280,0],[5,0],[280,0],
    [5,0],[ItemID.plantRope,0],[5,0],
    [280,0],[5,0],[280,0],
],0);

for(let i in craftingHammers){
RecipeSystem.addRecipeToWorkbench(ItemID.craftFileIron,1,0,[
    [0,0],[0,0],[265,0],
    [0,0],[265,0],[0,0],
    [280,0],[0,0],[0,0],
],craftingHammers[i]);

RecipeSystem.addRecipeToWorkbench(54,1,0,[
    [5,0],[5,0],[5,0],
    [5,0],[ItemID.chestLatch,0],[5,0],
    [5,0],[5,0],[5,0],
],craftingHammers[i]);

}

for(i in craftingFiles){

RecipeSystem.addRecipeToWorkbench(ItemID.chestLatch,1,0,[
    [265,0],[0,0],[0,0],
    [265,0],[0,0],[0,0],
    [0,0],[0,0],[0,0],
],craftingFiles[i]);

}

RecipePattern.pickaxeRecipe({id:ItemID.pickaxeIron,count:1,data:0},{ingot:265,plate:ItemID.plateIron,binding:ItemID.bindingIron});
RecipePattern.axeRecipe({id:ItemID.axeIron,count:1,data:0},{ingot:265,plate:ItemID.plateIron,binding:ItemID.bindingIron});
RecipePattern.shovelRecipe({id:ItemID.shovelIron,count:1,data:0},{ingot:265,plate:ItemID.plateIron,binding:ItemID.bindingIron});
RecipePattern.swordRecipe({id:ItemID.swordIron,count:1,data:0},{ingot:265,plate:ItemID.plateIron,binding:ItemID.bindingIron});
RecipePattern.hoeRecipe({id:ItemID.hoeIron,count:1,data:0},{ingot:265,plate:ItemID.plateIron,binding:ItemID.bindingIron});

RecipePattern.pickaxeRecipe({id:ItemID.pickaxeDirium,count:1,data:0}, {ingot:ItemID.ingotDirium,plate:ItemID.plateDirium,binding:ItemID.bindingDirium});   
RecipePattern.axeRecipe({id:ItemID.axeDirium,count:1,data:0}, {ingot:ItemID.ingotDirium,plate:ItemID.plateDirium,binding:ItemID.bindingDirium});
RecipePattern.shovelRecipe({id:ItemID.shovelDirium,count:1,data:0}, {ingot:ItemID.ingotDirium,plate:ItemID.plateDirium,binding:ItemID.bindingDirium});
RecipePattern.swordRecipe({id:ItemID.swordDirium,count:1,data:0}, {ingot:ItemID.ingotDirium,plate:ItemID.plateDirium,binding:ItemID.bindingDirium});
RecipePattern.hoeRecipe({id:ItemID.hoeDirium,count:1,data:0}, {ingot:ItemID.ingotDirium,plate:ItemID.plateDirium,binding:ItemID.bindingDirium});

RecipePattern.pickaxeRecipe({id:ItemID.pickaxeCobalt,count:1,data:0}, {ingot:ItemID.ingotCobalt,plate:ItemID.plateCobalt,binding:ItemID.bindingCobalt});   
RecipePattern.axeRecipe({id:ItemID.axeCobalt,count:1,data:0}, {ingot:ItemID.ingotCobalt,plate:ItemID.plateCobalt,binding:ItemID.bindingCobalt});
RecipePattern.shovelRecipe({id:ItemID.shovelCobalt,count:1,data:0}, {ingot:ItemID.ingotCobalt,plate:ItemID.plateCobalt,binding:ItemID.bindingCobalt});
RecipePattern.swordRecipe({id:ItemID.swordCobalt,count:1,data:0}, {ingot:ItemID.ingotCobalt,plate:ItemID.plateCobalt,binding:ItemID.bindingCobalt});
RecipePattern.hoeRecipe({id:ItemID.hoeCobalt,count:1,data:0}, {ingot:ItemID.ingotCobalt,plate:ItemID.plateCobalt,binding:ItemID.bindingCobalt});

RecipeSystem.addRecipeToWorkbench(ItemID.craftHammerIron,1,0,[
    [0,0],[265,0],[265,0],
    [280,0],[280,0],[265,0],
    [0,0],[265,0],[265,0],
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.circuitRedIron,1,0,[
    [ItemID.civWire,0],[ItemID.plateIron,0],[ItemID.civWire,0],
    [ItemID.plateIron,0],[152,0],[ItemID.plateIron,0],
    [ItemID.civWire,0],[ItemID.plateIron,0],[ItemID.civWire,0],
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.craftHammerDirium,1,0,[
    [0,0],[ ItemID.ingotDirium ,0],[ ItemID.ingotDirium ,0],
    [280,0],[280,0],[ ItemID.ingotDirium ,0],
    [0,0],[ ItemID.ingotDirium ,0],[ ItemID.ingotDirium ,0],
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.craftHammerStone,1,0,[
    [0,0],[ ItemID.rockStone ,0],[ ItemID.rockStone ,0],
    [280,0],[287,0],[ ItemID.rockStone ,0],
    [0,0],[ ItemID.rockStone ,0],[ ItemID.rockStone ,0],
],0);
});




// file: others/coils.js

IDRegistry.genItemID("coilCopper");
Item.createItem("coilCopper", "Copper coil", {name: "coilCopper", meta: 0}, {stack: 64});

IDRegistry.genItemID("rodIron");
Item.createItem("rodIron", "Iron rod", {name: "rodIron", meta: 0}, {stack: 64});

IDRegistry.genItemID("rodIronCharged");
Item.createItem("rodIronCharged", "Â§bIron rod", {name: "rodIron", meta: 1}, {stack: 64});

Callback.addCallback("PostLoaded", function(){
RecipeSystem.addRecipeToWorkbench(ItemID.coilCopper,1,0,[
    [ItemID.civWire,0], [ItemID.civWire,0], [ItemID.civWire,0],
    [ItemID.civWire,0], [280,0], [ItemID.civWire,0] ,
    [ItemID.civWire,0] , [ItemID.civWire,0] , [ItemID.civWire,0] ,
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.electronicMotor,1,0,[
    [ItemID.civWire,0], [ItemID.plateIron,0], [ItemID.rodIron,0],
    [ItemID.plateIron,0], [ItemID.rodIronCharged,0], [ItemID.plateIron,0] ,
    [ItemID.rodIron,0] , [ItemID.plateIron,0] , [ItemID.civWire,0] ,
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.electronicPiston,1,0,[
    [ItemID.plateIron,0], [ItemID.plateIron,0], [ItemID.plateIron,0],
    [ItemID.civWire,0], [ItemID.rodIron,0], [ItemID.rodIron,0] ,
    [ItemID.civWire,0], [ItemID.electronicMotor,0], [0,0] ,
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.rodIronCharged,1,0,[
    [331,0], [331,0], [331,0],
    [331,0], [ItemID.rodIron,0], [331,0] ,
    [331,0], [331,0], [331,0] ,
],0);

for(i in craftingFiles){
  RecipePattern.withToolRecipe({id:ItemID.rodIron,data:0},{id:265,data:0},craftingFiles[i]);
}

});




// file: machine/registry.js

importLib("energylib", "*");

var CU = EnergyTypeRegistry.assureEnergyType("Eu", 1);

var MachineRegistry = {
	machineIDs: {},

	isMachine: function(id){
		return this.machineIDs[id];
	},

	registerPrototype: function(id, Prototype){
		// register render
		ICRender.getGroup("ic-wire").add(id, -1);
		// register ID
		this.machineIDs[id] = true;
		// setup energy value
		if (Prototype.defaultValues){
			Prototype.defaultValues.energy = 0;
		}
		else{
			Prototype.defaultValues = {
				energy: 0
			};
		}
		// copy functions
		if(!Prototype.getEnergyStorage){
			Prototype.getEnergyStorage = function(){
				return 0;
			};
		}
		ToolAPI.registerBlockMaterial(id, "stone", 1);
		Block.setDestroyTime(id, 3);
		TileEntity.registerPrototype(id, Prototype);
		EnergyTileRegistry.addEnergyTypeForId(id, CU);
	},

	// standart functions
	
	activateMachine: function(){
		if(!this.data.isActive){
			this.data.isActive = true;
		}
	},
	
	deactivateMachine: function(){
		if(this.data.isActive){
			this.data.isActive = false;
		}
	},
	
	basicEnergyReceiveFunc: function(type, src){
		var energyNeed = this.getEnergyStorage() - this.data.energy;
		this.data.energy += src.getAll(energyNeed);
	}
};




// file: machine/wire.js

function setupWireRender(id, groupName, width, preventSelfAdd) {
    let render = new ICRender.Model();
    BlockRenderer.setStaticICRender(id, 0, render);

    let boxes = [
        {side: [1, 0, 0], box: [0.5 + width / 2, 0.5 - width / 2, 0.5 - width / 2, 1, 0.5 + width / 2, 0.5 + width / 2]},
        {side: [-1, 0, 0], box: [0, 0.5 - width / 2, 0.5 - width / 2, 0.5 - width / 2, 0.5 + width / 2, 0.5 + width / 2]},
        {side: [0, 1, 0], box: [0.5 - width / 2, 0.5 + width / 2, 0.5 - width / 2, 0.5 + width / 2, 1, 0.5 + width / 2]},
        {side: [0, -1, 0], box: [0.5 - width / 2, 0, 0.5 - width / 2, 0.5 + width / 2, 0.5 - width / 2, 0.5 + width / 2]},
        {side: [0, 0, 1], box: [0.5 - width / 2, 0.5 - width / 2, 0.5 + width / 2, 0.5 + width / 2, 0.5 + width / 2, 1]},
        {side: [0, 0, -1], box: [0.5 - width / 2, 0.5 - width / 2, 0, 0.5 + width / 2, 0.5 + width / 2, 0.5 - width / 2]},
    ];

    let group = ICRender.getGroup(groupName);
    if (!preventSelfAdd) {
        group.add(id, -1);
    }

    for (let i in boxes) {
        let box = boxes[i];

        let model = BlockRenderer.createModel();
        model.addBox(box.box[0], box.box[1], box.box[2], box.box[3], box.box[4], box.box[5], id, 0);

        render.addEntry(model).asCondition(box.side[0], box.side[1], box.side[2], group, 0);
    }

    let modelOwn = BlockRenderer.createModel();
    modelOwn.addBox(0.5 - width / 2, 0.5 - width / 2, 0.5 - width / 2, 0.5 + width / 2, 0.5 + width / 2, 0.5 + width / 2, id, 0);
    render.addEntry(modelOwn);
}

IDRegistry.genItemID("civWire");
Item.createItem("civWire", "Wire", {name: "wire", meta: 0}, {stack: 64});

Item.registerUseFunction("civWire",function(coords){
let crd = coords.relative;
  if(World.getBlockID(crd.x,crd.y,crd.z)==0){
    World.setBlock(crd.x,crd.y,crd.z,BlockID.civCopperWire);
    Player.decreaseCarriedItem();
  }
});

IDRegistry.genBlockID("civCopperWire");
Block.createBlock("civCopperWire", [
    {name: "Wire", texture: [["wire", 0]], inCreative: false}
]);

Block.registerDropFunction(BlockID.civCopperWire,function(coords,blockID,data,level,enchant){
  return [[ItemID.civWire,1,0]];
});

Block.registerPlaceFunction(BlockID.civCopperWire,function(coords,blockID,data,level,enchant){
  Game.prevent();
  Player.decreaseCarriedItem();
  Player.addItemToInventory(ItemID.civWire,1,0);
});


CU.registerWire(BlockID.civCopperWire);

setupWireRender(BlockID.civCopperWire, "ic-wire", 0.38);

//Block.setBlockShape(BlockID.civCopperWire, {x: 0.5, y: 0.4, z: 0.5}, {x: 0.8, y: 0.2, z: 0.8});

//alert("CivilizationCraft by Toncho(everything) & KypuJIKa(idea)\nSome ideas taked from PC mods: primal_core, primal_tech, BWM");

Callback.addCallback("PostLoaded", function () {
  RecipeSystem.addRecipeToWorkbench(ItemID.civWire,6,0,[
    [0,0],[0,0],[0,0],
    [ItemID.ingotCopper,0],[ItemID.ingotCopper,0],[ItemID.ingotCopper,0], 
    [0,0],[0,0],[0,0]
  ],0);
});




// file: mechanisms/clay_kiln.js

IDRegistry.genBlockID("unfiredClayKiln");
Block.createBlock("unfiredClayKiln", [
	{name: "Unfired kiln", texture: [
	["clayKiln",0],["clayKiln_top",0],["clayKiln",0]], inCreative: true}
]);
Block.setDestroyTime(BlockID.unfiredClayKiln,2);
ToolAPI.registerBlockMaterial(BlockID.clayKiln, "dirt", 1, true);
Block.setBlockShape(BlockID.unfiredClayKiln, {x: 0.1, y: 0, z: 0.1}, {x: 0.9, y: 0.1, z: 0.9});

var BLOCK_TEMP = {
  50: true,
  51: true,
  11: true,
  10: true
};

Block.setRandomTickCallback(BlockID.unfiredClayKiln, function(x,y,z,id,data) {
  if(BLOCK_TEMP[World.getBlockID(x,y-1,z)]){
    World.drop(x+0.5,y,z+0.5,BlockID.clayKiln,1,0);
    World.setBlock(x,y,z,0);
  }
});

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addRecipeToWorkbench(BlockID.unfiredClayKiln,1,0,[
  [337,0],[337,0],[337,0],
  [337,0], [0,0] ,[337,0],
  [337,0],[44,3], [337,0]]);
});

IDRegistry.genBlockID("clayKiln");
Block.createBlock("clayKiln", [
	{name: "Kiln", texture: [
	["clayKiln",1],["clayKiln_top",1],["clayKiln",1]], inCreative: true}
]);
Block.setDestroyTime(BlockID.clayKiln,3.5);
ToolAPI.registerBlockMaterial(BlockID.clayKiln, "stone", 1, true);
Block.setBlockShape(BlockID.clayKiln, {x: 0.1, y: 0, z: 0.1}, {x: 0.9, y: 0.1, z: 0.9});

TileEntity.registerPrototype(BlockID.clayKiln, {
  defaultValues:{id:0,data:0,progress:0, progressMax:450},
  initAnimation: function(){
		this.animation = new Animation.Item(this.x + .5, this.y+0.101, this.z + .5);
		if(this.data.id!=0){
		this.animation.describeItem({
			id: this.data.id,
			count: 1,
			data: this.data.data,
			rotation: [3.14/2, 0, 0],
			size: 0.6
		});
		this.animation.load();}
	},
	
	destroyAnimation: function(){
		if(this.animation){
			this.animation.destroy();
    }
	},
	
	updateAnimation: function(){
		this.destroyAnimation();
		this.initAnimation();
	},
	
	init: function(){
		this.initAnimation();
	},
	
	destroy: function(){
	  this.data.id=0;
		this.destroyAnimation();
	},
    tick:function(){
      if(this.data.id!=0){
	        if(World.getThreadTime()%35==0){
	            this.updateAnimation();
	        }
	    }else{
	        this.destroyAnimation();
	    }
        if(BLOCK_TEMP[World.getBlockID(this.x,this.y-1,this.z)]){
          let rec_ = RecipeSystem.getKilnRecipe();
            for(i in rec_){
                let rec = rec_[i];
                    if(this.data.id==rec.ing0&&this.data.data==rec.ingData0&&rec.ing1==0&&rec.ingCount0==1){
                        this.data.progress++;
                            if(this.data.progress>=this.data.progressMax){
                                this.data.progress=0;
                                this.data.id=rec.resId;
                                this.data.data=rec.resData;
                            }
                    }
               }
          }
    },
        click: function(){
        let item = Player.getCarriedItem();
        let rec_ = RecipeSystem.getKilnRecipe();
            for(i in rec_){
                let rec = rec_[i];
                    if(item.id==rec.ing0&&item.data==rec.ingData0){
                        Game.prevent();
                        Player.decreaseCarriedItem();
                        this.data.id=item.id;
                        this.data.data=item.data;
                    }
                    if(Entity.getSneaking(Player.get())&&this.data.id!=0){
                        World.drop(this.x+.5,this.y+1,this.z+.5,this.data.id,1,this.data.data);
                        this.data.id=this.data.data=0;
                    }
            }
     }
});




// file: mechanisms/kiln.js

IDRegistry.genBlockID("kilnBricks");
Block.createBlock("kilnBricks", [
	{name: "Kiln bricks", texture: [
	["kiln_bricks",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.kilnBricks,8.5);
ToolAPI.registerBlockMaterial(BlockID.kilnBricks, "stone", 1, true);

IDRegistry.genBlockID("alloyKilnController");
Block.createBlockWithRotation("alloyKilnController", [
	{name: "Alloy kiln", texture: [
	["kiln_bricks",0], ["kiln_controller_top",0], ["kiln_bricks",0],
  ["kiln_controller_front",0], ["kiln_bricks",0], ["kiln_bricks",0], ], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.alloyKilnController,8.5);
ToolAPI.registerBlockMaterial(BlockID.alloyKilnController, "stone", 1, true);

var alloyKilnGUI = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Kiln"}},
		inventory: {standart: true},
		background: {standart: true}
	},
	drawing: [
	  {type: "bitmap", x: 800-200, y: 140, bitmap: "furnProg_0", scale: 3.2},
	  {type: "bitmap", x: 710-200, y: 230, bitmap: "furnBurn_0", scale: 3.2},
	],
		 	elements: {
      "ing0": {type: "slot", x: 650-200, y: 140},
      "ing1": {type: "slot", x: 728-200, y: 140},
      "fuel": {type: "slot", x: 700-200, y: 280},
      
      "fuelScale": {type: "scale", x: 710-200, y: 230,
       bitmap: "furnBurn_1", scale: 3.2, direction: 1},
       
      "progressScale": {type: "scale", x: 800-200, y: 140, bitmap: "furnProg_1", scale: 3.2},
      "res" : {type: "slot", x: 900-200, y: 140},
	  }
});

TileEntity.registerPrototype(BlockID.alloyKilnController, {
    defaultValues: {
      heat:0, maxHeat:1, progress: 0, progressMax: 200
    },
    tick: function(){
      this.container.validateAll();
        this.container.setScale("fuelScale",this.data.heat/this.data.maxHeat);
        this.container.setScale("progressScale",this.data.progress/this.data.progressMax);
        let ing0 = this.container.getSlot("ing0");
        let ing1 = this.container.getSlot("ing1");
        let res = this.container.getSlot("res");
        let rec_ = RecipeSystem.getKilnRecipe();
        for(i in rec_){
            let rec = rec_[i];
            if(ing0.id==rec.ing0&&ing0.count>=rec.ingCount0&&ing0.data==rec.ingData0&&
              ing1.id==rec.ing1&&ing1.count>=rec.ingCount1&&ing1.data==rec.ingData1&&
              (res.id==rec.resId||res.id==0)&&res.count+rec.resCount<=64&&res.data==rec.resData){
              
                
                if(this.data.heat>0&&this.data.progress<this.data.progressMax){
                     this.data.progress++;
                }
                
                if(this.data.progress>=this.data.progressMax){
                    res.id=rec.resId; res.count+=rec.resCount; res.data=rec.resData;
                    ing0.count-=rec.ingCount0; ing1.count-=rec.ingCount1;
                }
            }
        }
      if(this.data.heat>0){
          this.data.heat--;
      }
      if(this.data.maxHeat>0&&this.data.heat==0){
          this.data.maxHeat=0;
      }
      for(i in RecipeSystem.getKilnRecipe()){
        let rec=RecipeSystem.getKilnRecipe()[i];
        let fuelSlot = this.container.getSlot("fuel");
          if(ing0.id==rec.ing0&&ing1.id==rec.ing1&&Fuel.getBurnTime(fuelSlot.id,fuelSlot.data)&&this.data.heat==0){
            this.data.maxHeat = Fuel.getBurnTime(fuelSlot.id,fuelSlot.data);
            this.data.heat = Fuel.getBurnTime(fuelSlot.id,fuelSlot.data);
            fuelSlot.count--;
          }
      }
      if(ing0.id==0&&this.data.progress>0){
        this.data.progress=0;
      }
      if(this.data.progress>=this.data.progressMax){
        this.data.progress=0;
      }
  },
  
    getGuiScreen: function(){
        return alloyKilnGUI;
    }
});




// file: mechanisms/anvil.js


Block.setAnvilRender = function(id,tex, data){
if(data==null){data=0;}
let anvilRender = new ICRender.Model();
BlockRenderer.setStaticICRender (id, -1, anvilRender);
var anvilModel = BlockRenderer.createModel();
//hat
anvilModel.addBox(2/16, 7/16, 0/16, 13/16, 0.8, 16/16, tex, data);
//foot
anvilModel.addBox(4/16, 0.01, 4/16, 11/16, 0.78, 12/16, tex, data);
//footer
anvilModel.addBox(4/16, 0.01, 0/16, 11/16, 2/16, 16/16, tex, data);
anvilRender.addEntry(anvilModel);}

IDRegistry.genBlockID("stoneAnvil");
Block.createBlock("stoneAnvil", [
	{name: "Primitive anvil", texture: [["cobblestone", 0]], inCreative: false}
]);
IDRegistry.genBlockID("ironAnvil");
Block.createBlock("ironAnvil", [
	{name: "Anvil", texture: [["iron_anvil", 0]], inCreative: false}
]);

IDRegistry.genItemID("anvilIron");
Item.createItem("anvilIron", "Iron anvil", {name: "ironAnvil", meta: 0}, {stack: 64});
IDRegistry.genItemID("anvilPrimal");
Item.createItem("anvilPrimal", "Primal anvil", {name: "primalAnvil", meta: 0}, {stack: 64});

Block.registerDropFunction(BlockID.stoneAnvil, function(){
  return [[ItemID.anvilPrimal,1,0]];
});

Block.registerDropFunction(BlockID.ironAnvil, function(){
  return [[ItemID.anvilIron,1,0]];
});

Item.registerUseFunction("anvilIron", function(coords){
  let crd = coords.relative;
    if(World.getBlockID(crd.x,crd.y,crd.z)==0){
      World.setBlock(crd.x,crd.y,crd.z,BlockID.ironAnvil);
      Player.decreaseCarriedItem();
    }
});

Item.registerUseFunction("anvilPrimal", function(coords){
  let crd = coords.relative;
    if(World.getBlockID(crd.x,crd.y,crd.z)==0){
      World.setBlock(crd.x,crd.y,crd.z,BlockID.stoneAnvil);
      Player.decreaseCarriedItem();
    }
});

Block.setAnvilRender(BlockID.stoneAnvil, 1);
Block.setAnvilRender(BlockID.ironAnvil, "iron_anvil");


Callback.addCallback("PostLoaded", function(){
  for(i in craftingHammers){
    RecipeSystem.addAnvilRecipe({id:ItemID.plateDowniron, count:1, data:0},ItemID.ingotDowniron,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.plateCopper, count:1, data:0},ItemID.ingotCopper,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.plateTin, count:1, data:0},ItemID.ingotTin,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.dustCoal, count:1, data:0},263,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.plateGold, count:1, data:0},266,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.dustCopper, count:1, data:0},ItemID.oreChunkCopper,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.dustTin, count:1, data:0},ItemID.oreChunkTin,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.dustIron, count:1, data:0},ItemID.oreChunkIron,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:331, count:1, data:0},ItemID.oreChunkRedstone,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:351, count:1, data:4},ItemID.oreChunkLapis,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:264, count:1, data:0},ItemID.oreChunkDiamond,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:388, count:1, data:0},ItemID.oreChunkEmerald,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.plateDirium, count:1, data:0},ItemID.ingotDirium,craftingHammers[2]);
    RecipeSystem.addAnvilRecipe({id:ItemID.plateIron, count:1, data:0},265,craftingHammers[i]);
    RecipeSystem.addAnvilRecipe({id:ItemID.plateCobalt, count:1, data:0},ItemID.ingotCobalt,craftingHammers[i]);
  }
});

TileEntity.registerPrototype(BlockID.stoneAnvil, {
  defaultValues: {id:0,data:0},
  initAnimation: function(){
		this.animation = new Animation.Item(this.x + .5, this.y+0.82, this.z + .5);
		if(this.data.id!=0){
		this.animation.describeItem({
			id: this.data.id,
			count: 1,
			data: this.data.data,
			rotation: [3.14/2, 0, 0],
			size: 0.6
		});
		this.animation.load();}
	},
	
	destroyAnimation: function(){
		if(this.animation){
			this.animation.destroy();
    }
	},
	
	updateAnimation: function(){
		this.destroyAnimation();
		this.initAnimation();
	},
	
	init: function(){
		this.initAnimation();
	},
	
	destroy: function(){
	  this.data.id=0;
		this.destroyAnimation();
	},
	tick: function(){
	  if(this.data.id!=0){
	    if(World.getThreadTime()%35==0){
	      this.updateAnimation();
	    }
	  }else{
	    this.destroyAnimation();
	  }
	},
	destroy: function(){
    World.drop(this.x+0.5,this.y+0.5,this.z+0.5,this.data.id,1,this.data.data);
    this.destroyAnimation();
  },
    click: function(){
    let item = Player.getCarriedItem();
      if(Entity.getSneaking(Player.get())&&this.data.id!=0&&item.id==0){
        World.drop(this.x+.5,this.y+1,this.z+.5,this.data.id,1,this.data.data);
        this.updateAnimation();
        this.data.id=this.data.data=0;
      }
      let rec_ = RecipeSystem.getAnvilRecipe();
        for(i in rec_){
          let rec = rec_[i];
          if(item.id==rec.item&&this.data.id==0){
            this.data.id=item.id;
            this.data.data=item.data;
            Player.decreaseCarriedItem();
            Game.prevent();
          }
            if(this.data.id==rec.item&&item.id==rec.tool){
              Item.breakCarried();
              World.drop(this.x+.5,this.y+1,this.z+.5,rec.resId,rec.resCount,rec.resData);
              PlaySoundFile("HammerUse.ogg");
              this.data.id=this.data.data=0; Game.prevent();
                if(rnd(1,20)==1){
                    World.destroyBlock(this.x,this.y,this.z);
                    this.destroyAnimation();
                }
            }
       }
   }
});

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addRecipeToWorkbench(ItemID.anvilPrimal,1,0,[
    [1,0],[1,0],[1,0],
    [0,0],[4,0],[0,0], 
    [4,0],[4,0],[4,0]
  ],0);
  RecipeSystem.addRecipeToWorkbench(ItemID.anvilIron,1,0,[
    [42,0],[42,0],[42,0],
    [0,0],[265,0],[0,0], 
    [265,0],[265,0],[265,0]
  ],0);
});

TileEntity.registerPrototype(BlockID.ironAnvil, {
  defaultValues: {id:0,data:0},
  initAnimation: function(){
		this.animation = new Animation.Item(this.x + .5, this.y+0.82, this.z + .5);
		if(this.data.id!=0){
		this.animation.describeItem({
			id: this.data.id,
			count: 1,
			data: this.data.data,
			rotation: [3.14/2, 0, 0],
			size: 0.6
		});
		this.animation.load();}
	},
	
	destroyAnimation: function(){
		if(this.animation){
			this.animation.destroy();
    }
	},
	
	updateAnimation: function(){
		this.destroyAnimation();
		this.initAnimation();
	},
	
	init: function(){
		this.initAnimation();
	},
	
	destroy: function(){
	  this.data.id=0;
		this.destroyAnimation();
	},
	tick: function(){
	  if(this.data.id!=0){
	    if(World.getThreadTime()%40==0){
	      this.updateAnimation();
	    }
	  }else{
	    this.destroyAnimation();
	  }
	},
	destroy: function(){
    World.drop(this.x+0.5,this.y+0.5,this.z+0.5,this.data.id,1,this.data.data);
    this.destroyAnimation();
  },
    click: function(){
    let item = Player.getCarriedItem();
      if(Entity.getSneaking(Player.get())&&this.data.id!=0&&item.id==0){
        World.drop(this.x+.5,this.y+1,this.z+.5,this.data.id,1,this.data.data);
        this.updateAnimation();
        this.data.id=this.data.data=0;
      }
      let rec_ = RecipeSystem.getAnvilRecipe();
        for(i in rec_){
          let rec = rec_[i];
          if(item.id==rec.item&&this.data.id==0){
            this.data.id=item.id;
            this.data.data=item.data;
            Player.decreaseCarriedItem();
            Game.prevent();
          }
            if(this.data.id==rec.item&&item.id==rec.tool){
              Item.breakCarried();
              World.drop(this.x+.5,this.y+1,this.z+.5,rec.resId,rec.resCount,rec.resData);
              this.data.id=this.data.data=0; Game.prevent();
              PlaySoundFile("HammerUse.ogg");
                if(rnd(1,200)==1){
                  if(rnd(1,20)==1){
                    World.destroyBlock(this.x,this.y,this.z);
                    this.destroyAnimation();}
                }
            }
       }
   }
});




// file: kinetic/reg.js

/*variations of type:

in - input energy, but doesn't give back
out - output energy, but doesn't take
io - can input and output energy

*/

var KineticMachine = {
  machineIDs: [],
  registerPrototype: function(id,prot){
  ICRender.getGroup("axle").add(id, -1);
  prot.isMachine = true;
    Block.setDestroyTime(id,3);
    this.machineIDs.push(id);
    TileEntity.registerPrototype(id,prot);
  }
};




// file: kinetic/axle.js

IDRegistry.genBlockID("axle");
Block.createBlock("axle", [
	{name: "Axle", texture: [
	["axleSide",0] , 	["axleSide",0] , 	["axleSide",0] ,
	["axleSide",0] , 	["axleSide",0] , 	["axleSide",0]],
	 inCreative: true}
]);

Block.setBlockShape(BlockID.axle, {x:0.3,y:0.3,z:0.3},{x:0.7,y:0.7,z:0.7});
setupWireRender(BlockID.axle, "axle", 0.2);

var axleDir = [
  {x: 0, y: 1, z: 0},
  {x: 0, y:-1, z: 0},
  {x: 0, y: 0, z: 1},
  {x: 0, y: 0, z:-1},
  {x: 1, y: 0, z: 0},
  {x:-1, y: 0, z: 0},
];

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addRecipeToWorkbench(BlockID.axle,2,0,[
    [ItemID.plantRope,0],[5,0],[ItemID.plantRope,0],
    [0,0],[ItemID.bark_oak,0],[0,0], 
    [ItemID.plantRope,0],[5,0],[ItemID.plantRope,0]
  ],0);
});

KineticMachine.registerPrototype(BlockID.axle,{
  defaultValues: {work: false},
  tick: function(){
    for(i in axleDir){
      let dir = axleDir[i];
      let tile = World.getTileEntity(this.x+dir.x,this.y+dir.y,this.z+dir.z);
      for(i in KineticMachine.machineIDs){
        if(World.getBlockID(this.x+dir.x,this.y+dir.y,this.z+dir.z)==KineticMachine.machineIDs[i]){
          if(tile&&(tile.type()=="in"||tile.type()=="io")&&!tile.data.work&&this.data.work){
            tile.data.work=true;
          }
          if(tile&&(tile.type()=="out"||tile.type()=="io")&&tile.data.work&&!this.data.work){
            this.data.work=true;
          }
        }
      }
    }
  },
  type: function(){
    return "io";
  }
});




// file: kinetic/gearbox.js

IDRegistry.genBlockID("gearbox");
Block.createBlock("gearbox", [
	{name: "Gearbox", texture: [
 ["gearbox",0]],
	 inCreative: true}
], "opaque");

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addRecipeToWorkbench(BlockID.gearbox,1,0,[
    [5,0],[ItemID.gearWooden,0],[5,0],
    [ItemID.gearWooden,0],[BlockID.axle,0],[ItemID.gearWooden,0], 
    [5,0],[ItemID.gearWooden,0],[5,0]
  ],0);
});

KineticMachine.registerPrototype(BlockID.gearbox,{
  defaultValues: {work: false},
  tick: function(){
  for(i in waterWheelDir){
    let dir = waterWheelDir[i];
    let tileGive = World.getTileEntity(this.x+dir.x,this.y,this.z+dir.z);
    if(tileGive&&(tileGive.type()=="in"||tileGive.type()=="io")&&this.data.work){
        tileGive.data.work=true;
      } else if(tileGive) tileGive.data.work=false;
    }
  },
  type: function(){
    return "io";
  }
});




// file: kinetic/watermill.js

IDRegistry.genBlockID("kineticWatermill");
Block.createBlock("kineticWatermill", [
	{name: "Waterwheel", texture: [
	["nothing",0]],
	 inCreative: false}
]);

IDRegistry.genItemID("haft");
Item.createItem("haft", "Haft", {name: "haft", meta: 0}, {stack: 64});

IDRegistry.genItemID("waterwheel_blade");
Item.createItem("waterwheel_blade", "Water wheel blade", {name: "waterwheel_blade", meta: 0}, {stack: 64});

IDRegistry.genItemID("waterwheel");
Item.createItem("waterwheel", "Water wheel", {name: "waterwheel", meta: 0}, {stack: 64});

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addRecipeToWorkbench(ItemID.waterwheel_blade ,1,0,[
    [0,0],[280,0],[0,0],
    [280,0],[ItemID.plantRope,0],[280,0], 
    [5,0],[280,0],[5,0]
  ],0);
  RecipeSystem.addRecipeToWorkbench(ItemID.waterwheel ,1,0,[
    [ItemID.waterwheel_blade,0],[ItemID.haft,0],[ItemID.waterwheel_blade,0],
    [ItemID.haft,0],[ItemID.gearWooden,0],[ItemID.haft,0], 
    [ItemID.waterwheel_blade,0],[ItemID.haft,0],[ItemID.waterwheel_blade,0]
  ],0);
});


var waterWheelDir = [
  {x:1,z:0},
  {x:-1,z:0},
  {x:0,z:1},
  {x:0,z:-1}
];

Item.registerUseFunction("waterwheel", function(coords,item,block){
  let plc = coords.relative;
  if(World.getBlockID(plc.x,plc.y,plc.z)==0&&World.getBlockID(plc.x,plc.y-1,plc.z)==0){
    World.setBlock(plc.x,plc.y,plc.z,BlockID.kineticWatermill);
    World.addTileEntity(plc.x,plc.y,plc.z);
    Player.setCarriedItem(item.id,item.count-1,0);
  } else if(Item.getName(280)=="ÐŸÐ°Ð»ÐºÐ°"){
    Game.message("ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð°, Ð´Ð»Ñ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ñ€Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ Ð²Ð¾Ð´ÑÐ½Ð¾Ðµ ÐºÐ¾Ð»ÐµÑÐ¾!");
  } else Game.message("There is not enough space to place a water wheel!");
});

Block.registerDropFunction(BlockID.kineticWatermill, function(){
  return [[ItemID.waterwheel,1,0]];
});

KineticMachine.registerPrototype(BlockID.kineticWatermill,{
  defaultValues: {work: false},
  initAnimation: function(){
   this.animation = new Animation.Item(this.x + .5, this.y+0.5, this.z + .5);
   	this.animation.describeItem({
  			id: ItemID.waterwheel,
  			count: 1,
  			data: 0,
	  		rotation: "z",
  			size: 2
		});
		this.animation.load();
	},
	
	destroyAnimation: function(){
	  	if(this.animation){
		  	 this.animation.destroy();
   }
	},
	
	updateAnimation: function(){
		this.destroyAnimation();
		this.initAnimation();
	},
	
	destroy: function(){
	  this.destroyAnimation();
	},
  tick: function(){
    let dir = waterWheelDir[i];
    if(World.getBlockID(this.x,this.y-1,this.z)==9&&World.getBlock(this.x,this.y-1,this.z).data>0){
      this.data.work=true;
      if(rnd(0,20)==20&&World.getThreadTime()%40==0){
        World.grop(this.x+0.5,this.y+1,this.z+0.5,349,1,rnd(0,3));
      }
    }
    if(World.getThreadTime()%50==0){
      this.data.work=false;
    }
  },
  init: function(){
    this.initAnimation();
  },
  destroy: function(){
    this.destroyAnimation();
  },
  type: function(){
    return "out";
  }
});




// file: kinetic/mill.js

 IDRegistry.genBlockID("kineticGrindmill");
Block.createBlock("kineticGrindmill", [
	{name: "Grindmill", texture: [
	["mill_bottom",0],	["mill_top",0],	["mill_side",0],
	["mill_side",0],	["mill_side",0], ["mill_side",0]],
	 inCreative: true}
],"opaque");

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addRecipeToWorkbench(BlockID.kineticGrindmill ,1,0,[
    [318,0],[1,0],[318,0],
    [1,0],[ItemID.gearWooden,0],[1,0], 
    [318,0],[1,0],[318,0]
  ],0);
});

var guiGrindmill = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Grindmill"}},
		inventory: {standart: true},
		background: {standart: true}
	},
	
	drawing: [
   {type: "bitmap", x: 550, y: 150, bitmap: "gear_scale0", scale: 3.2},
	],
	
	elements: {
		"progressScale": {type: "scale", x: 550, y: 150, value: 0.5, bitmap: "gear_scale1", scale: 3.2},
  "ingridient": {type: "slot", x: 450, y: 150},
  "result": {type: "slot", x: 650, y: 150}
  }
});

KineticMachine.registerPrototype(BlockID.kineticGrindmill,{
  defaultValues: {work: false, progress: 0, progressMax: 400},
  getGuiScreen: function(){
    return guiGrindmill;
  },
  tick: function(){
    this.container.setScale("progressScale", this.data.progress / 400 || 0);
	   	this.container.validateAll();
		
		
		let ing = this.container.getSlot("ingridient");
		let res = this.container.getSlot("result");
		
		let rec = RecipeSystem.getGrinderRecipe(ing.id,ing.data);
		
    if(rec&&this.data.work){
      this.data.progress++;
      if(this.data.progress>=this.data.progressMax&&(res.id==rec.id&&res.data==rec.data&&res.count+rec.count<=64 || res.id == 0)){
		      res.id = rec.id;
		      res.data = rec.data;
		      res.count+= rec.count;
		      ing.count--;
		      this.data.progress=0;
		    }
		  } else if(this.data.progress>0) this.data.progress=0;
  },
  type: function(){
    return "in";
  }
});




// file: kinetic/manipulator.js

/*IDRegistry.genBlockID("manipulator0");
Block.createBlock("manipulator0", [
	{name: "Manipulator", texture: [
	["manipulator",0]],
	 inCreative: true}
]);

KineticMachine.registerPrototype(BlockID.manipulator0, {
  defaultValues: {
    work: false,
    time: 0,
  },
  tick: function(){
    let dirs = [{y:1},{y:-1}];
    
    for(d in dirs){
      let dir = dirs[d];
      let tile = World.getTileEntity(this.x,this.y+dir.y,this.z);
      if(tile&&tile.getTransportSlots){
        for(i in tile.getTransportSlots.input){
        for(o in tile.getTransportSlots.output){
          let inp = tile.getTransportSlots.input[i];
          let out = tile.getTransportSlots.output[i];
          let input = tile.container.getSlot(inp);
          let output = tile.container.getSlot(out);
          if(input.id!=0&&(output.id==0||output.id==input.id)&&this.data.work){
            time++;
              if(time>=40){
                input.count--;
                output.count++;
                output.id = input.id;
                time=0;
              }
            }
          }
        }
      }
    }


  },
  type: function(){
    return "in";
  }
});*/




// file: machine/basic.js

IDRegistry.genBlockID("machineBlockBasic");
Block.createBlock("machineBlockBasic", [
	{name: "Machine casing", texture: [
	["primitiveGenerator",1]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.machineBlockBasic,3.5);
ToolAPI.registerBlockMaterial(BlockID.machineBlockBasic, "stone", 2, true);

Callback.addCallback("PostLoaded", function(){

  RecipeSystem.addRecipeToWorkbench(BlockID.machineBlockBasic,1,0,[
      [ 265 , 0], [ ItemID.plateIron , 0], [ 265 , 0],
      [ ItemID.plateIron , 0], [0,0], [ ItemID.plateIron , 0], 
      [ 265 , 0], [ ItemID.plateIron , 0], [ 265 , 0],
  ],craftingHammers[i]);

});

IDRegistry.genBlockID("machineBlockDowniron");
Block.createBlock("machineBlockDowniron", [
	{name: "Downiron machine casing", texture: [
	["downiron_casing",1],["downiron_casing",1],["downiron_casing",0]], inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.machineBlockDowniron,3.5);
ToolAPI.registerBlockMaterial(BlockID.machineBlockDowniron, "stone", 2, true);

Callback.addCallback("PostLoaded", function(){

  RecipeSystem.addRecipeToWorkbench(BlockID.machineBlockDowniron,1,0,[
      [ ItemID.plateDowniron , 0], [ ItemID.plateIron , 0], [ ItemID.plateDowniron , 0],
      [ ItemID.plateIron , 0], [0,0], [ ItemID.plateIron , 0], 
      [ ItemID.plateDowniron , 0], [ ItemID.plateIron , 0], [ ItemID.plateDowniron , 0],
  ],craftingHammers[i]);

});




// file: machine/grinder.js

IDRegistry.genBlockID("mechCCGrinder");
Block.createBlock("mechCCGrinder", [
	{name: "Grinder", texture: [
	["primitiveGenerator",1] , 	["mechGrinderTop",0] , 	["primitiveGenerator",1] ,
	["primitiveGenerator",1] , 	["primitiveGenerator",1] , 	["primitiveGenerator",1]],
	 inCreative: true}
],"opaque");

var guiGrinder = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Grinder"}},
		inventory: {standart: true},
		background: {standart: true}
	},
	
	drawing: [
		{type: "bitmap", x: 530, y: 250, bitmap: "energy_bar0", scale: 3.2},
		{type: "bitmap", x: 450, y: 150, bitmap: "furnProg_0", scale: 3.2},
	],
	
	elements: {
		"energyScale": {type: "scale", x: 530, y: 250, direction: 0, value: 0.5, bitmap: "energy_bar1", scale: 3.2},
		"progressScale": {type: "scale", x: 450, y: 150, value: 0.5, bitmap: "furnProg_1", scale: 3.2},
  "textInfo": {type: "text", x: 500, y: 350, width: 300, height: 30, text: "0/"},
  "ingridient": {type: "slot", x: 350, y: 150},
  "result": {type: "slot", x: 550, y: 150}
  }
});

Callback.addCallback("PostLoaded", function(){
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkCopper,data:0},{id:ItemID.dustCopper, count:2, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkTin,data:0},{id:ItemID.dustTin, count:2, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkCobalt,data:0},{id:ItemID.dustCobalt, count:2, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkDowniron,data:0},{id:ItemID.dustDowniron, count:2, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkDirium,data:0},{id:ItemID.dustDirium, count:1, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkIron,data:0},{id:ItemID.dustIron, count:2, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkRedstone,data:0},{id:331, count:4, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkLapis,data:0},{id:351, count:3, data:4});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkDiamond,data:0},{id:264, count:1, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkEmerald,data:0},{id:388, count:1, data:0});
  RecipeSystem.addGrinderRecipe({id:ItemID.oreChunkGold,data:0},{id:ItemID.dustGold, count:1, data:0});

  RecipeSystem.addRecipeToWorkbench(BlockID.mechCCGrinder,1,0,[
    [318,0],[264,0],[318,0],
    [264,0],[BlockID.machineBlockBasic,0],[264,0], 
    [ItemID.circuitRedIron,0],[ItemID.civWire,0],[ItemID.circuitRedIron,0]
  ],0);
});

MachineRegistry.registerPrototype(BlockID.mechCCGrinder, {
  defaultValues: {
    progress: 0,
	   progressMax: 220,
	},
 getTransportSlots: function(){
	 return {input: ["ingridient"], output: ["result"]};
	},
	getGuiScreen: function(){
		return guiGrinder;
	},
	tick: function(){
		var energyStorage = this.getEnergyStorage();
		this.container.setScale("progressScale", this.data.progress / this.data.progressMax || 0);
		this.container.setScale("energyScale", this.data.energy / this.getEnergyStorage());
		this.container.setText("textInfo", Math.round(this.data.energy) + "/" + energyStorage +" EU");
		this.container.validateAll();
		
		
		let ing = this.container.getSlot("ingridient");
		let res = this.container.getSlot("result");
		
		let rec = RecipeSystem.getGrinderRecipe(ing.id,ing.data);
		  if(rec){
		    if(this.data.energy>=10){
		      this.data.energy-=10;
		      this.data.progress++;
		    }
		    if(this.data.progress>=this.data.progressMax&&(res.id==rec.id&&res.data==rec.data&&res.count+rec.count<=64 || res.id == 0)){
		      res.id = rec.id;
		      res.data = rec.data;
		      res.count+= rec.count;
		      ing.count--;
		      this.data.progress=0;
		    }
		  } else if(this.data.progress>0) this.data.progress=0;
  	},
  	isGenerator: function() {
	   	return false;
  	},
	 getEnergyStorage: function(){
	   	return 10000;
  	},
  	energyTick: MachineRegistry.basicEnergyReceiveFunc,
});




// file: machine/gen/primitive.js

IDRegistry.genBlockID("machineGeneratorPrimal");
Block.createBlockWithRotation("machineGeneratorPrimal", [
	{name: "Primal generator", texture: [
	["primitiveGenerator",1] , 	["primitiveGenerator",1] , 	["primitiveGenerator",1] ,
	["primitiveGenerator",0] , 	["primitiveGenerator",1] , 	["primitiveGenerator",1]],
	 inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.machineGeneratorPrimal,3.5);
ToolAPI.registerBlockMaterial(BlockID.machineGeneratorPimal, "stone", 2, true);

Callback.addCallback("PostLoaded",function(){
for(i in craftingHammers){
  RecipeSystem.addRecipeToWorkbench(BlockID.machineGeneratorPrimal,1,0,[
      [ ItemID.plateIron , 0], [ BlockID.machineBlockBasic , 0], [ ItemID.plateIron , 0],
      [ ItemID.plateIron , 0], [ ItemID.electronicPiston , 0], [ ItemID.plateIron , 0], 
      [ ItemID.plateIron , 0], [ ItemID.electronicMotor , 0], [ ItemID.plateIron , 0],
  ],craftingHammers[i]);
}
});

var primalGeneratorGUI = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Primal generator"}},
		inventory: {standart: true},
		background: {standart: true}
	},
	drawing: [
	  {type: "bitmap", x: 505, y: 230, bitmap: "furnBurn_0", scale: 3.2},
	  {type: "bitmap", x: 600, y: 230, bitmap: "energy_bar0", scale: 3.2},
	],
		 	elements: {
      "fuelSlot": {type: "slot", x: 505, y: 280},
      "fuelScale": {type: "scale", x: 505, y: 230, bitmap: "furnBurn_1", scale: 3.2, direction: 1},
      "energyScale": {type: "scale", x: 600, y: 230, bitmap: "energy_bar1", scale: 3.2},
      "textInfo": {type: "text", x: 600, y: 200, width: 300, height: 30, text: "Energy: "},
	  }
});


MachineRegistry.registerPrototype(BlockID.machineGeneratorPrimal, {
 defaultValues: {
	  burn: 0,
	 	 burnMax: 0,
		 isActive: false
	},
    
	getGuiScreen: function(){
		return primalGeneratorGUI;
	},
	
  tick: function(){
    let slotFuel = this.container.getSlot("fuelSlot");
    
    if(this.data.burn>0) this.container.setScale("fuelScale", this.data.burn/this.data.burnMax);
      
    this.container.setScale("energyScale",this.data.energy/10000);
      FUEL = Fuel.getBurnTime(slotFuel.id,slotFuel.data);
    
    this.container.setText("textInfo","Energy: "+this.data.energy+"/"+this.getEnergyStorage());
    
    if(FUEL){
      this.data.burnMax = FUEL;
        if(this.data.burn==0&&this.data.energy<10000){
          slotFuel.count--;
          this.data.burn+=FUEL;
          this.activate();
        }
    }
    
    if(!FUEL){
      this.data.burnMax=0;
      this.deactivate();
    }
    
    if(this.data.burn>0){
        this.data.burn--;
      if(this.data.energy+20<this.getEnergyStorage()){
        this.data.energy += 20;
      }
    }
    
    this.container.validateAll();
    
  },
	
	isGenerator: function() {
		return true;
	},
	
	getEnergyStorage: function(){
		return 10000;
	},
	
	energyTick: function(type, src){
   var output = Math.min(20, this.data.energy);
  		this.data.energy += src.add(output) - output;
	},
	
	activate: MachineRegistry.activateMachine,
	deactivate: MachineRegistry.deactivateMachine,
	destroy: this.deactivate,
});




// file: machine/energy/kiln.js

IDRegistry.genBlockID("machineElectricKiln");
Block.createBlockWithRotation("machineElectricKiln", [
	{name: "Electrical kiln", texture: [
	["primitiveGenerator",1] , 	["primitiveGenerator",1] , 	["primitiveGenerator",1] ,
	["electricalKiln",0] , 	["primitiveGenerator",1] , 	["primitiveGenerator",1]],
	 inCreative: true}
],"opaque");
Block.setDestroyTime(BlockID.machineElectricKiln,3.5);
ToolAPI.registerBlockMaterial(BlockID.machineElectricKiln, "stone", 2, true);

Callback.addCallback("PostLoaded",function(){
for(i in craftingHammers){
  RecipeSystem.addRecipeToWorkbench(BlockID.machineElectricKiln,1,0,[
      [ 0 , 0], [ 331 , 0], [ 0 , 0], 
      [ ItemID.plateIron , 0], [ BlockID.alloyKilnController , 0], [ ItemID.plateIron , 0], 
      [ ItemID.plateIron , 0], [ ItemID.circuitRedIron , 0], [ ItemID.plateIron , 0],
  ],craftingHammers[i]);
}
});

var electricKilnGUI = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Kiln"}},
		inventory: {standart: true},
		background: {standart: true}
	},
	drawing: [
	  {type: "bitmap", x: 600, y: 140, bitmap: "furnProg_0", scale: 3.2},
	  {type: "bitmap", x: 510, y: 230, bitmap: "electroFire0", scale: 3.2},
	],
		 	elements: {
      "ing0": {type: "slot", x: 650-200, y: 140},
      "ing1": {type: "slot", x: 728-200, y: 140},
      
      "fireScale": {type: "scale", x: 510, y: 230, bitmap: "electroFire1", scale: 3.2, direction: 1},
       "res" : {type: "slot", x: 700, y: 140},
      "progressScale": {type: "scale", x: 600, y: 140, bitmap: "furnProg_1", scale: 3.2},
	  }
});



MachineRegistry.registerPrototype(BlockID.machineElectricKiln, {
  defaultValues: {
    progress: 0,
    progressMax: 165,
		  isActive: false
	},
    
	getGuiScreen: function(){
		return electricKilnGUI ;
	},
	
  tick: function(){
    this.container.setScale("fireScale",this.data.energy/10000);
    this.container.setScale("progressScale",this.data.progress/this.data.progressMax);
    this.container.validateAll();
    
    let ing0 = this.container.getSlot("ing0");
    let ing1 = this.container.getSlot("ing1");
    let res = this.container.getSlot("res");
    
    let rec_ = RecipeSystem.kiln;
    
    for(i in rec_){
    let rec = rec_[i];
      if(ing0.id==rec.ing0&&ing0.count>=rec.ingCount0&&ing0.data==rec.ingData0&&
        ing1.id==rec.ing1&&ing1.count>=rec.ingCount1&&ing1.data==rec.ingData1&&
        (res.id==rec.resId||res.id==0)&&res.count+rec.resCount<=64&&res.data==rec.resData){
         if(this.data.energy>20&&this.data.progress<this.data.progressMax){
            this.data.progress++;
            this.data.energy-=10;
         }
         if(this.data.progress>=this.data.progressMax){
           res.id=rec.resId; res.count+=rec.resCount; res.data=rec.resData;
           ing0.count-=rec.ingCount0; ing1.count-=rec.ingCount1;
           this.data.progress=0;
        }
      }
    }
    if(ing0.id==0&&this.data.progress>0){
      this.data.progress=0;
    }
  },
	
  	isGenerator: function() {
	   	return false;
  	},
	 getEnergyStorage: function(){
	   	return 10000;
  	},
	
  	activate: MachineRegistry.activateMachine,
  	deactivate: MachineRegistry.deactivateMachine,
  	destroy: this.deactivate,
  	energyTick: MachineRegistry.basicEnergyReceiveFunc
});




// file: machine/energy/workbench.js

IDRegistry.genBlockID("downironCraftingTable");
Block.createBlock("downironCraftingTable", [
	{name: "Downiron crafting table", texture: [
	["downiron_casing",1] , 	["downiron_craftingtable",0] , ["downiron_casing",0] ], inCreative: true}
],"opaque");

var dctGUI = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Craft II"}},
		inventory: {standart: true},
		background: {standart: true}
	},
	 	drawing: [
	  {type: "bitmap", x: 528, y: 292, bitmap: "energy_bar0", scale: 3.2},
	],
		 	elements: {
		 	"energyScale": {type: "scale", x: 528, y: 292, bitmap: "energy_bar1", scale: 3.2},
		  "res": {type: "slot", x: 592+128, y: 100},
      "ing0": {type: "slot", x: 464, y: 100},
      "ing1": {type: "slot", x: 528, y: 100},
      "ing2": {type: "slot", x: 592, y: 100},
      "ing3": {type: "slot", x: 464, y: 164},
      "ing4": {type: "slot", x: 528, y: 164},
      "ing5": {type: "slot", x: 592, y: 164},
      "ing6": {type: "slot", x: 464, y: 228},
      "ing7": {type: "slot", x: 528, y: 228},
      "ing8": {type: "slot", x: 592, y: 228},
      "textInfo": {type: "text", x: 550, y: 350, width: 300, height: 30, text: "Energy: "},
		  "button": {type: "button", x: 592+64, y: 100, bitmap: "craftBtn_0",bitmap2: "craftBtn_1",scale: 3.2,
		clicker: {
			onClick: function(container, tileEntity){
				tileEntity.data.craft = true;}}
    }
  }
});

MachineRegistry.registerPrototype(BlockID.downironCraftingTable, {
    defaultValues: {
      craft: false
    },
    getGuiScreen: function(){
      return dctGUI;
    },
    getEnergyStorage: function(){
	    return 50000;
    },
    tick: function(){
      let ing0 = this.container.getSlot("ing0");
      let ing1 = this.container.getSlot("ing1");
      let ing2 = this.container.getSlot("ing2");
      let ing3 = this.container.getSlot("ing3");
      let ing4 = this.container.getSlot("ing4");
      let ing5 = this.container.getSlot("ing5");
      let ing6 = this.container.getSlot("ing6");
      let ing7 = this.container.getSlot("ing7");
      let ing8 = this.container.getSlot("ing8");
      this.container.setText("textInfo","Energy: "+this.data.energy+"/"+this.getEnergyStorage());
      let res = this.container.getSlot("res");
      this.container.setScale("energyScale", this.data.energy/50000);
      let rec_ = RecipeSystem.getWorkbenchRecipe();
      
      if(this.data.craft){
      
      for(i in rec_){
      let rec = rec_[i];
      
        if( ing0.id==rec.ing0 && ing0.data==rec.ingData0 && ing1.id==rec.ing1 && ing1.data==rec.ingData1 &&
            ing2.id==rec.ing2 && ing2.data==rec.ingData2 && ing3.id==rec.ing3 && ing3.data==rec.ingData3 &&
            ing4.id==rec.ing4 && ing4.data==rec.ingData4 && ing5.id==rec.ing5 && ing5.data==rec.ingData5 &&
            ing6.id==rec.ing6 && ing6.data==rec.ingData6 && ing7.id==rec.ing7 && ing7.data==rec.ingData7 &&
            ing8.id==rec.ing8 && ing8.data==rec.ingData8 &&
              ( res.id == 0 || res.id == rec.resId ) && rec.level>0 && rec.level<2 &&
              res.count+rec.resCount<=Item.getMaxStack( rec.resId, rec.resData ) && this.data.energy>=512){
              ing0.count--; ing1.count--; ing2.count--;
              ing3.count--; ing4.count--; ing5.count--;
              ing6.count--; ing7.count--; ing8.count--;
              res.id=rec.resId; res.count+=rec.resCount; res.data=rec.resData;
              this.data.energy-=512;
          }
      }
      this.container.validateAll();
      if(this.data.craft&&World.getThreadTime()%1==0){
        this.data.craft=false;
        this.container.validateAll();
      }
    }
  },
  isGenerator: function() {
	  return false;
  },
	
  	activate: MachineRegistry.activateMachine,
  	deactivate: MachineRegistry.deactivateMachine,
  	destroy: this.deactivate,
  	energyTick: MachineRegistry.basicEnergyReceiveFunc
});




// file: vanila_recipes.js

Callback.addCallback("PostLoaded", function(){
let cobble = [4,BlockID.cobbleAndesite,BlockID.cobbleDiorite,BlockID.cobbleGranite]

for(let r in cobble){
let cobb = cobble[r];
RecipeSystem.addRecipeToWorkbench(ItemID.pickaxeStone,1,0,[
    [cobb,0],[cobb,0],[cobb,0],
    [0,0],[280,0],[287,0], 
    [0,0],[280,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(ItemID.axeStone,1,0,[
    [cobb,0],[cobb,0],[287,0],
    [cobb,0],[280,0],[cobb,0], 
    [0,0],[280,0],[0,0]
],0);

RecipeSystem.addRecipeToWorkbench(69,1,0,[
    [280,0],[0,0],[0,0],
    [cobble[r],0],[0,0],[0,0], 
    [0,0],[0,0],[0,0]
],0);


RecipeSystem.addRecipeToWorkbench(44,3,3,[
    [0,0],[0,0],[0,0],
    [cobble[r],0],[cobble[r],0],[cobble[r],0], 
    [0,0],[0,0],[0,0]
],0);
RecipeSystem.addRecipeToWorkbench(139,3,0,[
    [0,0],[0,0],[0,0],
    [cobble[r],0],[cobble[r],0],[cobble[r],0], 
    [cobble[r],0],[cobble[r],0],[cobble[r],0]
],0);
RecipeSystem.addRecipeToWorkbench(67,3,0,[
    [cobble[r],0],[0,0],[0,0],
    [cobble[r],0],[cobble[r],0],[0,0], 
    [cobble[r],0],[cobble[r],0],[cobble[r],0]
],0);
RecipeSystem.addRecipeToWorkbench(67,3,0,[
    [0,0],[0,0],[cobble[r],0],
    [0,0],[cobble[r],0],[cobble[r],0], 
    [cobble[r],0],[cobble[r],0],[cobble[r],0]
],0);
}
for(i in craftingHammers){
RecipeSystem.addRecipeToWorkbench(325,1,0,[
    [ItemID.plateIron,0] , [0,0] , [ItemID.plateIron,0],
    [0,0] , [ItemID.plateIron,0] , [0,0],
    [0,0] , [0,0] , [0,0]
],craftingHammers[i])

RecipeSystem.addRecipeToWorkbench(ItemID.bindingIron,1,0,[
    [ItemID.plateIron,0] , [0,0] , [ItemID.plateIron,0],
    [0,0] , [ItemID.plateIron,0] , [0,0],
    [ItemID.plateIron,0] , [0,0] , [ItemID.plateIron,0]
],craftingHammers[i]);

RecipeSystem.addRecipeToWorkbench(ItemID.bindingCobalt,1,0,[
    [ItemID.plateCobalt,0] , [0,0] , [ItemID.plateCobalt,0],
    [0,0] , [ItemID.plateCobalt,0] , [0,0],
    [ItemID.plateCobalt,0] , [0,0] , [ItemID.plateCobalt,0]
],craftingHammers[i]);

RecipeSystem.addRecipeToWorkbench(ItemID.bindingDirium,1,0,[
    [ItemID.plateDirium,0] , [0,0] , [ItemID.plateDirium,0],
    [0,0] , [ItemID.plateDirium,0] , [0,0],
    [ItemID.plateDirium,0] , [0,0] , [ItemID.plateDirium,0]
],craftingHammers[i]);

}

RecipePattern.smallRecipe({id:35,data:0},{id:287,data:0});

RecipeSystem.addRecipeToWorkbench(102,16,0,[
    [20,0] , [20,0] , [20,0],
    [20,0] , [20,0] , [20,0],
    [0,0] , [0,0] , [0,0]
],0);

RecipeSystem.addRecipeToWorkbench(65,2,0,[
    [280,0] , [0,0] , [280,0],
    [280,0] , [280,0] , [280,0],
    [280,0] , [0,0] , [280,0]
],0);

RecipeSystem.addRecipeToWorkbench(355,1,0,[
    [35,0] , [35,0] , [35,0],
    [5,0] , [5,0] , [5,0],
    [280,0] , [0,0] , [280,0]
],0);

RecipeSystem.addRecipeToWorkbench(116,1,0,[
    [0,0] , [340,0] , [0,0],
    [264,0] , [49,0] , [264,0],
    [49,0] , [49,0] , [49,0]
],0);

RecipeSystem.addRecipeToWorkbench(154,1,0,[
    [ItemID.plateIron,0] , [331,0] , [ItemID.plateIron,0],
    [ItemID.plateIron,0] , [54,0] , [ItemID.plateIron,0],
    [0,0] , [ItemID.plateIron,0] , [0,0]
],0);

RecipeSystem.addRecipeToWorkbench(158,1,0,[
    [4,0] , [4,0] , [4,0],
    [4,0] , [54,0] , [4,0],
    [4,0] , [331,0] , [4,0]
],0);

RecipeSystem.addRecipeToWorkbench(356,1,0,[
    [0,0] , [0,0] , [0,0],
    [76,0] , [331,0] , [76,0],
    [1,0] , [1,0] , [1,0]
],0);

RecipeSystem.addRecipeToWorkbench(359,1,0,[
    [0,0] , [ItemID.plateIron,0] , [0,0],
    [ItemID.plateIron,0] , [0,0] , [ItemID.plateIron,0],
    [265,0] , [ItemID.plateIron,0] , [0,0]
],0);

});


ModAPI.addAPICallback("EquivalentAPI",function(mod){
  System = mod.System;
  System.setValue(BlockID.cobbleAndesite,0,1);
  System.setValue(BlockID.cobbleDiorite,0,1);
  System.setValue(BlockID.cobbleGranite,0,1);
  System.setValue(ItemID.flakedFlint,0,4);
  System.setValue(ItemID.ingotDirium,0,4096);
  System.setValue(ItemID.ingotDowniron,0,512);
  System.setValue(ItemID.plantFiber,0,1);
  System.setValue(ItemID.plantRope,0,4);
  
RecipeSystem.addRecipeToWorkbench(ItemID.alch,1,0,[
  [263,0],[263,0],[263,0],
  [263,0],[0,0],[0,0], 
  [0,0],[0,0],[0,0]
],ItemID.philo,false);

RecipeSystem.addRecipeToWorkbench(ItemID.mobius,1,0,[
  [ItemID.alch,0],[ItemID.alch,0],[ItemID.alch,0],
  [ItemID.alch,0],[0,0],[0,0], 
  [0,0],[0,0],[0,0]
],ItemID.philo,false);

RecipeSystem.addRecipeToWorkbench(ItemID.aeternal,1,0,[
  [ItemID.mobius,0],[ItemID.mobius,0],[ItemID.mobius,0],
  [ItemID.mobius,0],[0,0],[0,0], 
  [0,0],[0,0],[0,0]
],ItemID.philo,false);

RecipePattern.metalBlock({id:BlockID.fuel0,data:0},{id:ItemID.alch,data:0});
RecipePattern.metalBlock({id:BlockID.fuel1,data:0},{id:ItemID.mobius,data:0});
RecipePattern.metalBlock({id:BlockID.fuel2,data:0},{id:ItemID.aeternal,data:0});

RecipeSystem.addRecipeToWorkbench(ItemID.darkMatter,1,0,[
  [ItemID.aeternal,0],[ItemID.aeternal,0],[ItemID.aeternal,0],
  [ItemID.aeternal,0],[57,0],[ItemID.aeternal,0], 
  [ItemID.aeternal,0],[ItemID.aeternal,0],[ItemID.aeternal,0]
],ItemID.philo,false);

RecipeSystem.addRecipeToWorkbench(ItemID.redMatter,1,0,[
  [ItemID.aeternal,0],[ItemID.aeternal,0],[ItemID.aeternal,0],
  [0,0],[ItemID.darkMatter],[0,0], 
  [ItemID.aeternal,0],[ItemID.aeternal,0],[ItemID.aeternal,0]
],ItemID.philo,false);

});


const BLOCK_TYPE_STONE = "opaque";




// file: api/shared.js

ModAPI.registerAPI("CivCore", {
  Tool: ToolBuilder,
	Recipe: RecipeSystem,
	FuelRegistry: Fuel,
	requireGlobal: function(command){
		return eval(command);
	}
});




// file: api/ic.js

ModAPI.addAPICallback("ICore", function(api){
  for(i in craftingHammers){
    
  }
  RecipePattern.withToolRecipe({id:ItemID.cableCopper0,count:2,data:0},{id:ItemID.plateTin,data:0},ItemID.craftingCutter);
  RecipePattern.withToolRecipe({id:ItemID.cableTin0,count:3,data:0},{id:ItemID.plateCopper,data:0},ItemID.craftingCutter);
  RecipePattern.withToolRecipe({id:ItemID.cableGold0,count:3,data:0},{id:ItemID.plateGold,data:0},ItemID.craftingCutter);
  
    RecipeSystem.addRecipeToWorkbench( ItemID.cableCopper1 ,1,0,[
      [ ItemID.cableCopper0 , 0], [ ItemID.rubber , 0], [ 0 , 0],
      [ 0 , 0], [ 0 ,0], [ 0 , 0], 
      [ 0 , 0], [ 0 , 0], [ 0 , 0],
    ], 0);
    RecipeSystem.addRecipeToWorkbench( ItemID.cableTin1 ,1,0,[
      [ ItemID.cableCopper0 , 0], [ ItemID.rubber , 0], [ 0 , 0],
      [ 0 , 0], [ 0 ,0], [ 0 , 0], 
      [ 0 , 0], [ 0 , 0], [ 0 , 0],
    ], 0);
    RecipeSystem.addRecipeToWorkbench( ItemID.cableGold1 ,1,0,[
      [ ItemID.cableGold0 , 0], [ ItemID.rubber , 0], [ ItemID.rubber , 0],
      [ 0 , 0], [ 0 ,0], [ 0 , 0], 
      [ 0 , 0], [ 0 , 0], [ 0 , 0],
    ], 0);
    RecipeSystem.addRecipeToKiln(ItemID.rubber,2,0,[[ItemID.latex,1,0],[0,0,0]]);
    
    RecipeSystem.addRecipeToKiln(ItemID.ingotSteel,1,0,[[265,1,0],[ItemID.dustCoal,2,0]]);
    RecipeSystem.addRecipeToKiln(ItemID.ingotSteel,1,0,[[265,1,0],[ItemID.dustCharcoal,4,0]]);
    craftingHammers.push(ItemID.craftingHammer);
});






// file: api/guide.js

IDRegistry.genBlockID("helpCraftingTable");
Block.createBlock("helpCraftingTable", [
	{name: "Recipes table", texture: [
	["log",0]], inCreative: true}
]);

Callback.addCallback("PostLoaded", function(){
for(dataa=0;dataa<5;dataa++){
  RecipeSystem.addRecipeToWorkbench(BlockID.helpCraftingTable,1,0,[
      [ 5 , dataa], [ 5 , dataa], [ 0 , 0],
      [ 5 , dataa], [ 5 , dataa], [ 0 , 0], 
      [ 0 , 0], [ 0 , 0], [ 0 , 0],
  ]);
}
});


var tableRender = new ICRender.Model;
BlockRenderer.setStaticICRender(BlockID.helpCraftingTable, 0, tableRender);
var tableModel = BlockRenderer.createModel();
//hat
tableModel.addBox(0/16, 14/16, 0/16, 16/16, 1, 16/16, "log", 0);
//foot
tableModel.addBox(2/16, 0, 2/16, 14/16, 14/16, 14/16, "log", 0);

tableRender.addEntry(tableModel);

Callback.addCallback ("DestroyBlockStart", function(c,b){
  let entity = World.getTileEntity(c.x,c.y,c.z);
    if(entity&&b.id==BlockID.helpCraftingTable){
        for(sl=0;sl<9;sl++){
          entity.container.setSlot("ing"+sl,0,0,0);
          entity.container.setSlot("res",0,0,0);
          entity.container.setSlot("slotTool",0,0,0);
        }
      World.destroyBlock(c.x,c.y,c.z,false);
      World.drop(c.x+.5,c.y+.5,c.z+.5,BlockID.helpCraftingTable,1,0);
    }
});

var halpGUI = new UI.StandartWindow({
	standart: {
		header: {text: {text: "Craft Helper"}},
		background: {standart: true}
	},
		 	elements: {
		  "res": {type: "slot", visual: true, x: 592, y: 164},
      "ing0": {type: "slot", visual: true, x: 364, y: 100},
      "ing1": {type: "slot", visual: true, x: 428, y: 100},
      "ing2": {type: "slot", visual: true, x: 492, y: 100},
      "ing3": {type: "slot", visual: true, x: 364, y: 164},
      "ing4": {type: "slot", visual: true, x: 428, y: 164},
      "ing5": {type: "slot", visual: true, x: 492, y: 164},
      "ing6": {type: "slot", visual: true, x: 364, y: 228},
      "ing7": {type: "slot", visual: true, x: 428, y: 228},
      "ing8": {type: "slot", visual: true, x: 492, y: 228},
      "slotTool": {type: "slot", visual: true, x: 592+64, y: 228, bitmap: "slotTool"},
		  "buttonNxt": {type: "button", x: 492, y: 350, bitmap: "btn_next0",bitmap2: "btn_next1",scale: 3.2,
		clicker: {
			onClick: function(container, tileEntity){
			  if(tileEntity.data.page<RecipeSystem.workbench.length-1){
				tileEntity.data.page++;}else{tileEntity.data.page=0;}
				}
		  }
    },
    "buttonBck": {type: "button", x: 364, y: 350, bitmap: "btn_back0",bitmap2: "btn_back1",scale: 3.2,
		clicker: {
			onClick: function(container, tileEntity){
			  if(tileEntity.data.page>0){
				tileEntity.data.page--;}else{tileEntity.data.page=RecipeSystem.workbench.length-1;}
				}
		  }
    },
    "textInfo": {type: "text", x: 492+(492-364), y: 400, width: 300, height: 30, text: "0/"},
    "textLevel": {type: "text", x: 492+(492-364), y: 300, width: 300, height: 30, text: "Level: "},
  }
});

TileEntity.registerPrototype( BlockID.helpCraftingTable, {
    defaultValues: {
      page:0
    },
    getGuiScreen: function(){
      return halpGUI;
    },
    tick: function(){
      let ing0 = this.container.getSlot("ing0");
      let ing1 = this.container.getSlot("ing1");
      let ing2 = this.container.getSlot("ing2");
      let ing3 = this.container.getSlot("ing3");
      let ing4 = this.container.getSlot("ing4");
      let ing5 = this.container.getSlot("ing5");
      let ing6 = this.container.getSlot("ing6");
      let ing7 = this.container.getSlot("ing7");
      let ing8 = this.container.getSlot("ing8");
      
      let tool = this.container.getSlot("slotTool");
      let res = this.container.getSlot("res");
      let content = this.container.getGuiContent();
      
      this.container.validateAll();
      
      let rec_ = RecipeSystem.getWorkbenchRecipe();
      
         let p=this.data.page;
         this.container.setText("textInfo", this.data.page+1 + "/" + rec_.length);
         this.container.setText("textLevel", "Level: "+rec_.level);
      if(content){
         ing0.id=rec_[p].ing0; ing1.id=rec_[p].ing1; ing2.id=rec_[p].ing2;
         ing3.id=rec_[p].ing3; ing4.id=rec_[p].ing4; ing5.id=rec_[p].ing5;
         ing6.id=rec_[p].ing6; ing7.id=rec_[p].ing7; ing8.id=rec_[p].ing8;
         
         ing0.data=rec_[p].ingData0; ing1.data=rec_[p].ingData1; ing2.data=rec_[p].ingData2;
         ing3.data=rec_[p].ingData3; ing4.data=rec_[p].ingData4; ing5.data=rec_[p].ingData5;
         ing6.data=rec_[p].ingData6; ing7.data=rec_[p].ingData7; ing8.data=rec_[p].ingData8;
         
         res.id=rec_[p].resId; res.count=rec_[p].resCount; res.data=rec_[p].resData;
         tool.id=rec_[p].toolId; tool.count=1;
         
         ing0.count=ing1.count=ing2.count=ing3.count=ing4.count=ing5.count=ing6.count=ing7.count=ing8.count=1;
      }
   }
});




