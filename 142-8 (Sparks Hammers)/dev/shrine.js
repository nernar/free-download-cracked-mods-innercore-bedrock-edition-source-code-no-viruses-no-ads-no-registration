IDRegistry.genBlockID("block_mjolnir");
Block.createBlock("block_mjolnir", [{name: "Mjolnir", texture: [["iron_block", 0]], inCreative: true}]);
ToolAPI.registerBlockMaterial(BlockID.block_mjolnir, "stone");
Block.setDestroyTime(BlockID.block_mjolnir, -1);

(function(){
    const render = new ICRender.Model();
    const model = BlockRenderer.createModel();
    model.addBox(01/16, 01/16, 05/16, 15/16, 07/16, 11/16, "iron_block", 0);
    model.addBox(01/16, 00/16, 07/16, 15/16, 01/16, 09/16, "iron_block", 0);
    model.addBox(01/16, 07/16, 07/16, 15/16, 08/16, 09/16, "iron_block", 0);
    model.addBox(01/16, 03/16, 04/16, 15/16, 05/16, 05/16, "iron_block", 0);
    model.addBox(01/16, 03/16, 11/16, 15/16, 05/16, 12/16, "iron_block", 0);
    model.addBox(07/16, 08/16, 07/16, 09/16, 15/16, 09/16, VanillaBlockID.log, 0);
    model.addBox(06/16, 15/16, 06/16, 10/16, 16/16, 10/16, "anvil_base", 0);
    render.addEntry(model);
    BlockRenderer.setStaticICRender(BlockID.block_mjolnir, -1, render);
})();

Block.registerClickFunction("block_mjolnir", function(coords){
    const helmet = Player.getArmorSlot(0);
	if(helmet.id === 397 && helmet.data === 5){
        World.setBlock(coords.x, coords.y, coords.z, 0);
        World.drop(coords.x + 0.5, coords.y + 0.5, coords.z + 0.5, ItemID.shammer_mjolnir, 1, 0);
    }
    else{
        Entity.addEffect(player, Native.PotionEffect.weakness, 1, 200);
        Game.message("You need to equip a Dragon Head");
    }
});


const shrineChance = __config__.getNumber("gen_shrine_chance") || 0.005;

const shrineArray = [
	[4, 0, 0, {id: 156, data: 2}],
	[5, 0, 0, {id: 156, data: 2}],
	[6, 0, 0, {id: 156, data: 2}],
	[2, 0, 1, {id: 156, data: 0}],
	[3, 0, 1, {id: 156, data: 2}],
	[4, 0, 1, {id: 156, data: 0}],
	[5, 0, 1, {id: 155, data: 10}],
	[6, 0, 1, {id: 156, data: 1}],
	[7, 0, 1, {id: 156, data: 2}],
	[8, 0, 1, {id: 156, data: 1}],
	[1, 0, 2, {id: 156, data: 2}],
	[2, 0, 2, {id: 156, data: 0}],
	[3, 0, 2, {id: 155, data: 0}],
	[4, 0, 2, {id: 155, data: 0}],
	[5, 0, 2, {id: 155, data: 10}],
	[6, 0, 2, {id: 155, data: 0}],
	[7, 0, 2, {id: 155, data: 0}],
	[8, 0, 2, {id: 156, data: 1}],
	[9, 0, 2, {id: 156, data: 2}],
	[1, 0, 3, {id: 156, data: 0}],
	[2, 0, 3, {id: 155, data: 0}],
	[3, 0, 3, {id: 155, data: 0}],
	[4, 0, 3, {id: 155, data: 0}],
	[5, 0, 3, {id: 155, data: 10}],
	[6, 0, 3, {id: 155, data: 0}],
	[7, 0, 3, {id: 155, data: 0}],
	[8, 0, 3, {id: 155, data: 0}],
	[9, 0, 3, {id: 156, data: 1}],
	[0, 0, 4, {id: 156, data: 2}],
	[1, 0, 4, {id: 156, data: 0}],
	[2, 0, 4, {id: 155, data: 0}],
	[3, 0, 4, {id: 155, data: 0}],
	[4, 0, 4, {id: 155, data: 0}],
	[5, 0, 4, {id: 89, data: 0}],
	[6, 0, 4, {id: 155, data: 0}],
	[7, 0, 4, {id: 155, data: 0}],
	[8, 0, 4, {id: 155, data: 0}],
	[9, 0, 4, {id: 156, data: 1}],
	[10, 0, 4, {id: 156, data: 2}],
	[0, 0, 5, {id: 156, data: 0}],
	[1, 0, 5, {id: 155, data: 6}],
	[2, 0, 5, {id: 155, data: 6}],
	[3, 0, 5, {id: 155, data: 6}],
	[4, 0, 5, {id: 89, data: 0}],
	[5, 0, 5, {id: 155, data: 0}],
	[6, 0, 5, {id: 89, data: 0}],
	[7, 0, 5, {id: 155, data: 6}],
	[8, 0, 5, {id: 155, data: 6}],
	[9, 0, 5, {id: 155, data: 6}],
	[10, 0, 5, {id: 156, data: 1}],
	[0, 0, 6, {id: 156, data: 3}],
	[1, 0, 6, {id: 156, data: 0}],
	[2, 0, 6, {id: 155, data: 0}],
	[3, 0, 6, {id: 155, data: 0}],
	[4, 0, 6, {id: 155, data: 0}],
	[5, 0, 6, {id: 89, data: 0}],
	[6, 0, 6, {id: 155, data: 0}],
	[7, 0, 6, {id: 155, data: 0}],
	[8, 0, 6, {id: 155, data: 0}],
	[9, 0, 6, {id: 156, data: 1}],
	[10, 0, 6, {id: 156, data: 3}],
	[1, 0, 7, {id: 156, data: 0}],
	[2, 0, 7, {id: 155, data: 0}],
	[3, 0, 7, {id: 155, data: 0}],
	[4, 0, 7, {id: 155, data: 0}],
	[5, 0, 7, {id: 155, data: 10}],
	[6, 0, 7, {id: 155, data: 0}],
	[7, 0, 7, {id: 155, data: 0}],
	[8, 0, 7, {id: 155, data: 0}],
	[9, 0, 7, {id: 156, data: 1}],
	[1, 0, 8, {id: 156, data: 3}],
	[2, 0, 8, {id: 156, data: 0}],
	[3, 0, 8, {id: 155, data: 0}],
	[4, 0, 8, {id: 155, data: 0}],
	[5, 0, 8, {id: 155, data: 10}],
	[6, 0, 8, {id: 155, data: 0}],
	[7, 0, 8, {id: 155, data: 0}],
	[8, 0, 8, {id: 156, data: 1}],
	[9, 0, 8, {id: 156, data: 3}],
	[2, 0, 9, {id: 156, data: 0}],
	[3, 0, 9, {id: 156, data: 3}],
	[4, 0, 9, {id: 155, data: 0}],
	[5, 0, 9, {id: 155, data: 10}],
	[6, 0, 9, {id: 155, data: 0}],
	[7, 0, 9, {id: 156, data: 3}],
	[8, 0, 9, {id: 156, data: 1}],
	[4, 0, 10, {id: 156, data: 3}],
	[5, 0, 10, {id: 156, data: 3}],
	[6, 0, 10, {id: 156, data: 3}],
	[3, 1, 3, {id: 155, data: 2}],
	[4, 1, 3, {id: 160, data: 0}],
	[5, 1, 3, {id: 160, data: 4}],
	[6, 1, 3, {id: 160, data: 0}],
	[7, 1, 3, {id: 155, data: 2}],
	[3, 1, 4, {id: 160, data: 0}],
	[4, 1, 4, {id: 171, data: 4}],
	[5, 1, 4, {id: 171, data: 4}],
	[6, 1, 4, {id: 171, data: 4}],
	[7, 1, 4, {id: 160, data: 0}],
	[3, 1, 5, {id: 160, data: 4}],
	[4, 1, 5, {id: 171, data: 4}],
	[5, 1, 5, {id: 155, data: 1}],
	[6, 1, 5, {id: 171, data: 4}],
	[7, 1, 5, {id: 160, data: 4}],
	[3, 1, 6, {id: 160, data: 0}],
	[4, 1, 6, {id: 171, data: 4}],
	[5, 1, 6, {id: 171, data: 4}],
	[6, 1, 6, {id: 171, data: 4}],
	[7, 1, 6, {id: 160, data: 0}],
	[3, 1, 7, {id: 155, data: 2}],
	[4, 1, 7, {id: 160, data: 0}],
	[5, 1, 7, {id: 160, data: 4}],
	[6, 1, 7, {id: 160, data: 0}],
	[7, 1, 7, {id: 155, data: 2}],
	[3, 2, 3, {id: 155, data: 2}],
	[4, 2, 3, {id: 160, data: 0}],
	[5, 2, 3, {id: 160, data: 4}],
	[6, 2, 3, {id: 160, data: 0}],
	[7, 2, 3, {id: 155, data: 2}],
	[3, 2, 4, {id: 160, data: 0}],
	[7, 2, 4, {id: 160, data: 0}],
	[3, 2, 5, {id: 160, data: 4}],
	[5, 2, 5, {id: BlockID.block_mjolnir, data: 0}],
	[7, 2, 5, {id: 160, data: 4}],
	[3, 2, 6, {id: 160, data: 0}],
	[7, 2, 6, {id: 160, data: 0}],
	[3, 2, 7, {id: 155, data: 2}],
	[4, 2, 7, {id: 160, data: 0}],
	[5, 2, 7, {id: 160, data: 4}],
	[6, 2, 7, {id: 160, data: 0}],
	[7, 2, 7, {id: 155, data: 2}],
	[3, 3, 3, {id: 155, data: 2}],
	[4, 3, 3, {id: 160, data: 0}],
	[5, 3, 3, {id: 160, data: 4}],
	[6, 3, 3, {id: 160, data: 0}],
	[7, 3, 3, {id: 155, data: 2}],
	[3, 3, 4, {id: 160, data: 0}],
	[7, 3, 4, {id: 160, data: 0}],
	[3, 3, 5, {id: 160, data: 4}],
	[7, 3, 5, {id: 160, data: 4}],
	[3, 3, 6, {id: 160, data: 0}],
	[7, 3, 6, {id: 160, data: 0}],
	[3, 3, 7, {id: 155, data: 2}],
	[4, 3, 7, {id: 160, data: 0}],
	[5, 3, 7, {id: 160, data: 4}],
	[6, 3, 7, {id: 160, data: 0}],
	[7, 3, 7, {id: 155, data: 2}],
	[3, 4, 2, {id: 156, data: 6}],
	[7, 4, 2, {id: 156, data: 6}],
	[2, 4, 3, {id: 156, data: 4}],
	[3, 4, 3, {id: 87, data: 0}],
	[4, 4, 3, {id: 155, data: 6}],
	[5, 4, 3, {id: 155, data: 6}],
	[6, 4, 3, {id: 155, data: 6}],
	[7, 4, 3, {id: 87, data: 0}],
	[8, 4, 3, {id: 156, data: 5}],
	[3, 4, 4, {id: 155, data: 10}],
	[4, 4, 4, {id: 44, data: 14}],
	[5, 4, 4, {id: 156, data: 6}],
	[6, 4, 4, {id: 44, data: 14}],
	[7, 4, 4, {id: 155, data: 10}],
	[3, 4, 5, {id: 155, data: 10}],
	[4, 4, 5, {id: 156, data: 4}],
	[6, 4, 5, {id: 156, data: 5}],
	[7, 4, 5, {id: 155, data: 10}],
	[3, 4, 6, {id: 155, data: 10}],
	[4, 4, 6, {id: 44, data: 14}],
	[5, 4, 6, {id: 156, data: 7}],
	[6, 4, 6, {id: 44, data: 14}],
	[7, 4, 6, {id: 155, data: 10}],
	[2, 4, 7, {id: 156, data: 4}],
	[3, 4, 7, {id: 87, data: 0}],
	[4, 4, 7, {id: 155, data: 6}],
	[5, 4, 7, {id: 155, data: 6}],
	[6, 4, 7, {id: 155, data: 6}],
	[7, 4, 7, {id: 87, data: 0}],
	[8, 4, 7, {id: 156, data: 5}],
	[3, 4, 8, {id: 156, data: 7}],
	[7, 4, 8, {id: 156, data: 7}],
	[3, 5, 3, {id: 51, data: 0}],
	[4, 5, 3, {id: 156, data: 0}],
	[5, 5, 3, {id: 41, data: 0}],
	[6, 5, 3, {id: 156, data: 1}],
	[7, 5, 3, {id: 51, data: 0}],
	[3, 5, 4, {id: 156, data: 2}],
	[4, 5, 4, {id: 156, data: 2}],
	[5, 5, 4, {id: 155, data: 0}],
	[6, 5, 4, {id: 156, data: 2}],
	[7, 5, 4, {id: 156, data: 2}],
	[3, 5, 5, {id: 41, data: 0}],
	[4, 5, 5, {id: 155, data: 0}],
	[5, 5, 5, {id: 155, data: 1}],
	[6, 5, 5, {id: 155, data: 0}],
	[7, 5, 5, {id: 41, data: 0}],
	[3, 5, 6, {id: 156, data: 3}],
	[4, 5, 6, {id: 156, data: 3}],
	[5, 5, 6, {id: 155, data: 0}],
	[6, 5, 6, {id: 156, data: 3}],
	[7, 5, 6, {id: 156, data: 3}],
	[3, 5, 7, {id: 51, data: 0}],
	[4, 5, 7, {id: 156, data: 0}],
	[5, 5, 7, {id: 41, data: 0}],
	[6, 5, 7, {id: 156, data: 1}],
	[7, 5, 7, {id: 51, data: 0}],
	[5, 6, 3, {id: 44, data: 6}],
	[5, 6, 4, {id: 44, data: 6}],
	[3, 6, 5, {id: 44, data: 6}],
	[4, 6, 5, {id: 44, data: 6}],
	[5, 6, 5, {id: 44, data: 6}],
	[6, 6, 5, {id: 44, data: 6}],
	[7, 6, 5, {id: 44, data: 6}],
	[5, 6, 6, {id: 44, data: 6}],
	[5, 6, 7, {id: 44, data: 6}]
];

Callback.addCallback("GenerateChunk", function(chunkX, chunkZ){
    if(Math.random() < shrineChance){
        const x = chunkX * 16 + 8;
        const z = chunkZ * 16 + 8;
        const y = GenerationUtils.findHighSurface(x, z).y;
        for(let i = 0; i < shrineArray.length; i++){
			World.setFullBlock(x + shrineArray[i][0] - 5, y + shrineArray[i][1], z + shrineArray[i][2] - 5, shrineArray[i][3]);
		}
    }
});